var ie=Object.create;var at=Object.defineProperty;var ue=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var ae=Object.getPrototypeOf,le=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var fe=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of ce(t))!le.call(e,s)&&s!==n&&at(e,s,{get:()=>t[s],enumerable:!(r=ue(t,s))||r.enumerable});return e};var he=(e,t,n)=>(n=e!=null?ie(ae(e)):{},fe(t||!e||!e.__esModule?at(n,"default",{value:e,enumerable:!0}):n,e));var J=I(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.anumber=G;O.abytes=lt;O.ahash=de;O.aexists=ye;O.aoutput=_e;function G(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function pe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function lt(e,...t){if(!pe(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function de(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");G(e.outputLen),G(e.blockLen)}function ye(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function _e(e,t){lt(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}});var Tt=I(a=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.add5L=a.add5H=a.add4H=a.add4L=a.add3H=a.add3L=a.rotlBL=a.rotlBH=a.rotlSL=a.rotlSH=a.rotr32L=a.rotr32H=a.rotrBL=a.rotrBH=a.rotrSL=a.rotrSH=a.shrSL=a.shrSH=a.toBig=void 0;a.fromBig=$;a.split=ft;a.add=Lt;var R=BigInt(2**32-1),Y=BigInt(32);function $(e,t=!1){return t?{h:Number(e&R),l:Number(e>>Y&R)}:{h:Number(e>>Y&R)|0,l:Number(e&R)|0}}function ft(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:o,l:i}=$(e[s],t);[n[s],r[s]]=[o,i]}return[n,r]}var ht=(e,t)=>BigInt(e>>>0)<<Y|BigInt(t>>>0);a.toBig=ht;var pt=(e,t,n)=>e>>>n;a.shrSH=pt;var dt=(e,t,n)=>e<<32-n|t>>>n;a.shrSL=dt;var yt=(e,t,n)=>e>>>n|t<<32-n;a.rotrSH=yt;var _t=(e,t,n)=>e<<32-n|t>>>n;a.rotrSL=_t;var bt=(e,t,n)=>e<<64-n|t>>>n-32;a.rotrBH=bt;var wt=(e,t,n)=>e>>>n-32|t<<64-n;a.rotrBL=wt;var kt=(e,t)=>t;a.rotr32H=kt;var mt=(e,t)=>e;a.rotr32L=mt;var gt=(e,t,n)=>e<<n|t>>>32-n;a.rotlSH=gt;var St=(e,t,n)=>t<<n|e>>>32-n;a.rotlSL=St;var xt=(e,t,n)=>t<<n-32|e>>>64-n;a.rotlBH=xt;var At=(e,t,n)=>e<<n-32|t>>>64-n;a.rotlBL=At;function Lt(e,t,n,r){let s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}var vt=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);a.add3L=vt;var Bt=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;a.add3H=Bt;var Ut=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);a.add4L=Ut;var zt=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0;a.add4H=zt;var Pt=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0);a.add5L=Pt;var Ot=(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0;a.add5H=Ot;var be={fromBig:$,split:ft,toBig:ht,shrSH:pt,shrSL:dt,rotrSH:yt,rotrSL:_t,rotrBH:bt,rotrBL:wt,rotr32H:kt,rotr32L:mt,rotlSH:gt,rotlSL:St,rotlBH:xt,rotlBL:At,add:Lt,add3L:vt,add3H:Bt,add4L:Ut,add4H:zt,add5H:Ot,add5L:Pt};a.default=be});var Ht=I(q=>{"use strict";Object.defineProperty(q,"__esModule",{value:!0});q.crypto=void 0;q.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var It=I(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.Hash=p.nextTick=p.byteSwapIfBE=p.isLE=void 0;p.isBytes=we;p.u8=ke;p.u32=me;p.createView=ge;p.rotr=Se;p.rotl=xe;p.byteSwap=rt;p.byteSwap32=Ae;p.bytesToHex=ve;p.hexToBytes=Be;p.asyncLoop=ze;p.utf8ToBytes=jt;p.toBytes=X;p.concatBytes=Pe;p.checkOpts=Oe;p.wrapConstructor=Te;p.wrapConstructorWithOpts=He;p.wrapXOFConstructorWithOpts=Ee;p.randomBytes=je;var H=Ht(),et=J();function we(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ke(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function me(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function ge(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Se(e,t){return e<<32-t|e>>>t}function xe(e,t){return e<<t|e>>>32-t>>>0}p.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function rt(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}p.byteSwapIfBE=p.isLE?e=>e:e=>rt(e);function Ae(e){for(let t=0;t<e.length;t++)e[t]=rt(e[t])}var Le=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ve(e){(0,et.abytes)(e);let t="";for(let n=0;n<e.length;n++)t+=Le[e[n]];return t}var A={_0:48,_9:57,A:65,F:70,a:97,f:102};function Et(e){if(e>=A._0&&e<=A._9)return e-A._0;if(e>=A.A&&e<=A.F)return e-(A.A-10);if(e>=A.a&&e<=A.f)return e-(A.a-10)}function Be(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=Et(e.charCodeAt(o)),u=Et(e.charCodeAt(o+1));if(i===void 0||u===void 0){let h=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+h+'" at index '+o)}r[s]=i*16+u}return r}var Ue=async()=>{};p.nextTick=Ue;async function ze(e,t,n){let r=Date.now();for(let s=0;s<e;s++){n(s);let o=Date.now()-r;o>=0&&o<t||(await(0,p.nextTick)(),r+=o)}}function jt(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function X(e){return typeof e=="string"&&(e=jt(e)),(0,et.abytes)(e),e}function Pe(...e){let t=0;for(let r=0;r<e.length;r++){let s=e[r];(0,et.abytes)(s),t+=s.length}let n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){let o=e[r];n.set(o,s),s+=o.length}return n}var tt=class{clone(){return this._cloneInto()}};p.Hash=tt;function Oe(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Te(e){let t=r=>e().update(X(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function He(e){let t=(r,s)=>e(s).update(X(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Ee(e){let t=(r,s)=>e(s).update(X(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function je(e=32){if(H.crypto&&typeof H.crypto.getRandomValues=="function")return H.crypto.getRandomValues(new Uint8Array(e));if(H.crypto&&typeof H.crypto.randomBytes=="function")return H.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}});var qt=I(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.shake256=_.shake128=_.keccak_512=_.keccak_384=_.keccak_256=_.keccak_224=_.sha3_512=_.sha3_384=_.sha3_256=_.sha3_224=_.Keccak=void 0;_.keccakP=Ct;var E=J(),N=Tt(),L=It(),Vt=[],Mt=[],Kt=[],Ie=BigInt(0),F=BigInt(1),Fe=BigInt(2),Ne=BigInt(7),Ve=BigInt(256),Me=BigInt(113);for(let e=0,t=F,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],Vt.push(2*(5*r+n)),Mt.push((e+1)*(e+2)/2%64);let s=Ie;for(let o=0;o<7;o++)t=(t<<F^(t>>Ne)*Me)%Ve,t&Fe&&(s^=F<<(F<<BigInt(o))-F);Kt.push(s)}var[Ke,Ce]=(0,N.split)(Kt,!0),Ft=(e,t,n)=>n>32?(0,N.rotlBH)(e,t,n):(0,N.rotlSH)(e,t,n),Nt=(e,t,n)=>n>32?(0,N.rotlBL)(e,t,n):(0,N.rotlSL)(e,t,n);function Ct(e,t=24){let n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let u=(i+8)%10,h=(i+2)%10,S=n[h],l=n[h+1],g=Ft(S,l,1)^n[u],j=Nt(S,l,1)^n[u+1];for(let m=0;m<50;m+=10)e[i+m]^=g,e[i+m+1]^=j}let s=e[2],o=e[3];for(let i=0;i<24;i++){let u=Mt[i],h=Ft(s,o,u),S=Nt(s,o,u),l=Vt[i];s=e[l],o=e[l+1],e[l]=h,e[l+1]=S}for(let i=0;i<50;i+=10){for(let u=0;u<10;u++)n[u]=e[i+u];for(let u=0;u<10;u++)e[i+u]^=~n[(u+2)%10]&n[(u+4)%10]}e[0]^=Ke[r],e[1]^=Ce[r]}n.fill(0)}var V=class e extends L.Hash{constructor(t,n,r,s=!1,o=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,E.anumber)(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,L.u32)(this.state)}keccak(){L.isLE||(0,L.byteSwap32)(this.state32),Ct(this.state32,this.rounds),L.isLE||(0,L.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,E.aexists)(this);let{blockLen:n,state:r}=this;t=(0,L.toBytes)(t);let s=t.length;for(let o=0;o<s;){let i=Math.min(n-this.pos,s-o);for(let u=0;u<i;u++)r[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,n&128&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){(0,E.aexists)(this,!1),(0,E.abytes)(t),this.finish();let n=this.state,{blockLen:r}=this;for(let s=0,o=t.length;s<o;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,o-s);t.set(n.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,E.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,E.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:n,suffix:r,outputLen:s,rounds:o,enableXOF:i}=this;return t||(t=new e(n,r,s,i,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=r,t.outputLen=s,t.enableXOF=i,t.destroyed=this.destroyed,t}};_.Keccak=V;var U=(e,t,n)=>(0,L.wrapConstructor)(()=>new V(t,e,n));_.sha3_224=U(6,144,224/8);_.sha3_256=U(6,136,256/8);_.sha3_384=U(6,104,384/8);_.sha3_512=U(6,72,512/8);_.keccak_224=U(1,144,224/8);_.keccak_256=U(1,136,256/8);_.keccak_384=U(1,104,384/8);_.keccak_512=U(1,72,512/8);var Rt=(e,t,n)=>(0,L.wrapXOFConstructorWithOpts)((r={})=>new V(t,e,r.dkLen===void 0?n:r.dkLen,!0));_.shake128=Rt(31,168,128/8);_.shake256=Rt(31,136,256/8)});var B=class extends Error{constructor(t){let n;t instanceof Error?n=t.message:typeof t=="string"?n=t:n="",super(n),this.name=this.constructor.name}};var C=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],Z=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441];var x=he(qt(),1);var Re={},Xt=qe(globalThis,Re);function qe(e,t){return new Proxy(e,{get(n,r,s){return r in t?t[r]:e[r]},set(n,r,s){return r in t&&delete t[r],e[r]=s,!0},deleteProperty(n,r){let s=!1;return r in t&&(delete t[r],s=!0),r in e&&(delete e[r],s=!0),s},ownKeys(n){let r=Reflect.ownKeys(e),s=Reflect.ownKeys(t),o=new Set(s);return[...r.filter(i=>!o.has(i)),...s]},defineProperty(n,r,s){return r in t&&delete t[r],Reflect.defineProperty(e,r,s),!0},getOwnPropertyDescriptor(n,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(n,r){return r in t||r in e}})}function d(e){return e%256}function k(e){return e>=-32768&&e<=32767?e:e<-32768?(e=e+32769,e=e%65536,32767+e):(e=e-32768,e=e%65536,-32768+e)}function c(e){return e%65536}function D(e){return e>=-2147483648&&e<=2147483647?e:e<-2147483648?(e=e+2147483649,e=e%4294967296,2147483647+e):(e=e-2147483648,e=e%4294967296,-2147483648+e)}function w(e){return e%4294967296}function Dt(e,t){if(e.length!=t.length)return 0;let n=new Uint8Array([0]);for(let s=0;s<e.length;s++)n[0]|=e[s]^t[s];let r=new Uint8Array([0]);return r[0]=~(n[0]^r[0]),r[0]&=r[0]>>4,r[0]&=r[0]>>2,r[0]&=r[0]>>1,r[0]}function Qt(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}async function Wt(){if(typeof Xt<"u"&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:e}=await import("crypto");return e}catch{throw new Error("failed to load Crypto")}}function M(e,t,n){return x.shake256.create({dkLen:e}).update(t).update(new Uint8Array([n])).digest()}function Zt(e){let t=w(e[0]);return t|=w(e[1])<<8,t|=w(e[2])<<16,t}function Gt(e){let t=w(e[0]);return t|=w(e[1])<<8,t|=w(e[2])<<16,t|=w(e[3])<<24,w(t)}var P=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_skSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pkSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedUSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedVSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}async generateKeyPair(){await this._setup();try{let t=new Uint8Array(64);return this._api.getRandomValues(t),this._deriveKeyPair(t)}catch(t){throw new B(t)}}async deriveKeyPair(t){await this._setup();try{if(t.byteLength!==64)throw new Error("seed must be 64 bytes in length");return this._deriveKeyPair(t)}catch(n){throw new B(n)}}async encap(t,n){await this._setup();try{if(t.length!==384*this._k+32)throw new Error("invalid encapsulation key");let r=this._getSeed(n),[s,o]=nt(r,Jt(t));return[this._encap(t,r,o),s]}catch(r){throw new B(r)}}async decap(t,n){await this._setup();try{if(t.byteLength!==this._compressedUSize+this._compressedVSize)throw new Error("Invalid ct size");if(n.length!==768*this._k+96)throw new Error("Invalid decapsulation key");let r=n.subarray(0,this._skSize),s=n.subarray(this._skSize,this._skSize+this._pkSize),o=n.subarray(this._skSize+this._pkSize,this._skSize+this._pkSize+32),i=n.subarray(this._skSize+this._pkSize+32,this._skSize+this._pkSize+64),u=this._decap(t,r),[h,S]=nt(u,o),l=Qe(i,t),g=this._encap(s,u,S);return Dt(t,g)===1?h:l}catch(r){throw new B(r)}}async _setup(){this._api===void 0&&(this._api=await Wt())}_getSeed(t){if(t==null){let n=new Uint8Array(32);return this._api.getRandomValues(n),n}if(t.byteLength!==32)throw new Error("seed must be 32 bytes in length");return t}_deriveKeyPair(t){let n=t.subarray(0,32),r=t.subarray(32,64),[s,o]=this._deriveCpaKeyPair(n),i=Jt(s),u=new Uint8Array(this._skSize+this._pkSize+64);return u.set(o,0),u.set(s,this._skSize),u.set(i,this._skSize+this._pkSize),u.set(r,this._skSize+this._pkSize+32),[s,u]}_deriveCpaKeyPair(t){let[n,r]=nt(t,new Uint8Array([this._k])),s=this._sampleMatrix(n,!1),o=this._sampleNoise1(r,0,this._k),i=this._sampleNoise1(r,this._k,this._k);for(let l=0;l<this._k;l++)o[l]=Q(o[l]),o[l]=T(o[l]),i[l]=Q(i[l]);let u=new Array(this._k);for(let l=0;l<this._k;l++)u[l]=Je(W(s[l],o)),u[l]=K(u[l],i[l]),u[l]=T(u[l]);let h=new Uint8Array(this._pkSize);for(let l=0;l<this._k;l++)h.set(st(u[l]),l*384);h.set(n,this._skSize);let S=new Uint8Array(this._skSize);for(let l=0;l<this._k;l++)S.set(st(o[l]),l*384);return[h,S]}_encap(t,n,r){let s=new Array(this._k),o=new Uint8Array(384*this._k);for(let y=0;y<this._k;y++)s[y]=Yt(t.subarray(y*384,(y+1)*384)),o.set(st(s[y]),y*384);if(!Qt(t.subarray(0,o.length),o))throw new Error("invalid encapsulation key");let i=t.subarray(this._skSize),u=this._sampleMatrix(i,!0),h=this._sampleNoise1(r,0,this._k),S=this._sampleNoise2(r,this._k,this._k),l=this._sampleNoise2(r,this._k*2,1)[0];for(let y=0;y<this._k;y++)h[y]=Q(h[y]),h[y]=T(h[y]);let g=new Array(this._k);for(let y=0;y<this._k;y++)g[y]=W(u[y],h),g[y]=ot(g[y]),g[y]=K(g[y],S[y]),g[y]=T(g[y]);let j=Ge(n),m=W(s,h);m=ot(m),m=K(m,l),m=K(m,j),m=T(m);let v=new Uint8Array(this._compressedUSize+this._compressedVSize);return this._compressU(v.subarray(0,this._compressedUSize),g),this._compressV(v.subarray(this._compressedUSize),m),v}_decap(t,n){let r=this._decompressU(t.subarray(0,this._compressedUSize)),s=this._decompressV(t.subarray(this._compressedUSize)),o=this._polyvecFromBytes(n);for(let u=0;u<this._k;u++)r[u]=Q(r[u]);let i=W(o,r);return i=ot(i),i=Ye(s,i),i=T(i),Ze(i)}_sampleMatrix(t,n){let r=new Array(this._k),s=new Uint8Array(2);for(let o=0,i=0;i<this._k;i++){r[i]=new Array(this._k);for(let u=0;u<this._k;u++){n?(s[0]=i,s[1]=u):(s[0]=u,s[1]=i);let h=We(t,s),S=$t(h.subarray(0,504),504,256);for(r[i][u]=S[0],o=S[1];o<256;){let l=h.subarray(504,672),g=$t(l,168,256-o),j=g[0],m=g[1];for(let v=o;v<256;v++)r[i][u][v]=j[v-o];o=o+m}}}return r}_sampleNoise1(t,n,r){let s=new Array(r);for(let o=0;o<r;o++)s[o]=te(M(this._eta1*256/4,t,n),this._eta1),n++;return s}_sampleNoise2(t,n,r){let s=new Array(r);for(let o=0;o<r;o++)s[o]=te(M(this._eta2*256/4,t,n),this._eta2),n++;return s}_polyvecFromBytes(t){let n=new Array(this._k);for(let r=0;r<this._k;r++)n[r]=Yt(t.subarray(r*384,(r+1)*384));return n}_compressU(t,n){let r=new Array(4);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/4;i++){for(let u=0;u<4;u++)r[u]=((n[o][4*i+u]<<10)+3329/2)/3329&1023;t[s++]=d(r[0]>>0),t[s++]=d(r[0]>>8|r[1]<<2),t[s++]=d(r[1]>>6|r[2]<<4),t[s++]=d(r[2]>>4|r[3]<<6),t[s++]=d(r[3]>>2)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let s=0,o=0;o<256/8;o++){for(let i=0;i<8;i++)r[i]=d(((n[8*o+i]<<4)+3329/2)/3329)&15;t[s++]=r[0]|r[1]<<4,t[s++]=r[2]|r[3]<<4,t[s++]=r[4]|r[5]<<4,t[s++]=r[6]|r[7]<<4}return t}_decompressU(t){let n=new Array(this._k);for(let s=0;s<this._k;s++)n[s]=new Array(384);let r=new Array(4);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/4;i++){r[0]=c(t[s+0])>>0|c(t[s+1])<<8,r[1]=c(t[s+1])>>2|c(t[s+2])<<6,r[2]=c(t[s+2])>>4|c(t[s+3])<<4,r[3]=c(t[s+3])>>6|c(t[s+4])<<2,s=s+5;for(let u=0;u<4;u++)n[o][4*i+u]=k(w(r[u]&1023)*w(3329)+512>>10)}return n}_decompressV(t){let n=new Array(384);for(let r=0,s=0;s<256/2;s++,r++)n[2*s+0]=k(c(t[r]&15)*c(3329)+8>>4),n[2*s+1]=k(c(t[r]>>4)*c(3329)+8>>4);return n}};function nt(e,t){let n=x.sha3_512.create().update(e);t!==void 0&&n.update(t);let r=n.digest();return[r.subarray(0,32),r.subarray(32,64)]}function Jt(e){return x.sha3_256.create().update(e).digest()}function Qe(e,t){let n=x.shake256.create({dkLen:32}).update(e);return t!==void 0&&n.update(t),n.digest()}function We(e,t){return x.shake128.create({dkLen:672}).update(e).update(t).digest()}function st(e){let t=0,n=0,r=new Uint8Array(384),s=oe(e);for(let o=0;o<256/2;o++)t=c(s[2*o]),n=c(s[2*o+1]),r[3*o+0]=d(t>>0),r[3*o+1]=d(t>>8)|d(n<<4),r[3*o+2]=d(n>>4);return r}function Yt(e){let t=new Array(384).fill(0);for(let n=0;n<256/2;n++)t[2*n]=k((c(e[3*n+0])>>0|c(e[3*n+1])<<8)&4095),t[2*n+1]=k((c(e[3*n+1])>>4|c(e[3*n+2])<<4)&4095);return t}function Ze(e){let t=new Uint8Array(32),n,r=oe(e);for(let s=0;s<256/8;s++){t[s]=0;for(let o=0;o<8;o++)n=((c(r[8*s+o])<<1)+c(3329/2))/c(3329)&1,t[s]|=d(n<<o)}return t}function Ge(e){let t=new Array(384).fill(0),n;for(let r=0;r<256/8;r++)for(let s=0;s<8;s++)n=-1*k(e[r]>>s&1),t[8*r+s]=n&k(3330/2);return t}function $t(e,t,n){let r=new Array(384).fill(0),s=0,o,i;for(let u=0;s<n&&u+3<=t;)o=(c(e[u]>>0)|c(e[u+1])<<8)&4095,i=(c(e[u+1]>>4)|c(e[u+2])<<4)&4095,u=u+3,o<3329&&(r[s]=o,s=s+1),s<n&&i<3329&&(r[s]=i,s=s+1);return[r,s]}function te(e,t){let n,r,s,o,i=new Array(384).fill(0);for(let u=0;u<256/8;u++){n=Gt(e.subarray(4*u,e.length)),r=n&1431655765,r=r+(n>>1&1431655765);for(let h=0;h<8;h++)s=k(r>>4*h+0&3),o=k(r>>4*h+t&3),i[8*u+h]=s-o}return i}function Q(e){for(let t=0,n=1,r=128;r>=2;r>>=1)for(let s=0;s<256;s=t+r){let o=C[n];for(n=n+1,t=s;t<s+r;t++){let i=z(o,e[t+r]);e[t+r]=e[t]-i,e[t]=e[t]+i}}return e}function z(e,t){return se(e*t)}function T(e){for(let t=0;t<256;t++)e[t]=ne(e[t]);return e}function ne(e){let n=(16777216+3329/2)/3329*e>>24;return n=n*3329,e-n}function se(e){let n=k(D(e)*62209)*3329;return n=e-n,n>>=16,k(n)}function Je(e){for(let n=0;n<256;n++)e[n]=se(D(e[n])*D(1353));return e}function W(e,t){let n=ee(e[0],t[0]),r;for(let s=1;s<e.length;s++)r=ee(e[s],t[s]),n=K(n,r);return T(n)}function ee(e,t){let n,r;for(let s=0;s<256/4;s++)n=re(e[4*s+0],e[4*s+1],t[4*s+0],t[4*s+1],C[64+s]),r=re(e[4*s+2],e[4*s+3],t[4*s+2],t[4*s+3],-C[64+s]),e[4*s+0]=n[0],e[4*s+1]=n[1],e[4*s+2]=r[0],e[4*s+3]=r[1];return e}function re(e,t,n,r,s){let o=new Array(2);return o[0]=z(t,r),o[0]=z(o[0],s),o[0]+=z(e,n),o[1]=z(e,r),o[1]+=z(t,n),o}function K(e,t){let n=new Array(384);for(let r=0;r<256;r++)n[r]=e[r]+t[r];return n}function Ye(e,t){for(let n=0;n<256;n++)e[n]-=t[n];return e}function ot(e){let t=0;for(let n=0,r=2;r<=128;r<<=1)for(let s=0;s<256;s=t+r){let o=Z[n];for(n=n+1,t=s;t<s+r;t++){let i=e[t];e[t]=ne(i+e[t+r]),e[t+r]=i-e[t+r],e[t+r]=z(o,e[t+r])}}for(t=0;t<256;t++)e[t]=z(e[t],Z[127]);return e}function oe(e){for(let t=0;t<256;t++)e[t]-=3329,e[t]+=e[t]>>31&3329;return e}var it=class extends P{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_sampleNoise1(t,n,r){let s=new Array(r);for(let o=0;o<r;o++)s[o]=$e(M(this._eta1*256/4,t,n),this._eta1),n++;return s}};function $e(e,t){let n,r,s,o,i=new Array(384).fill(0);for(let u=0;u<256/4;u++){n=Zt(e.subarray(3*u,e.length)),r=n&2396745,r=r+(n>>1&2396745),r=r+(n>>2&2396745);for(let h=0;h<4;h++)s=k(r>>6*h+0&7),o=k(r>>6*h+t&7),i[4*u+h]=s-o}return i}var ut=class extends P{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}};var ct=class extends P{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:11}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_compressU(t,n){let r=new Array(8);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/8;i++){for(let u=0;u<8;u++)r[u]=c(((w(n[o][8*i+u])<<11)+w(3329/2))/w(3329)&2047);t[s++]=d(r[0]>>0),t[s++]=d(r[0]>>8|r[1]<<3),t[s++]=d(r[1]>>5|r[2]<<6),t[s++]=d(r[2]>>2),t[s++]=d(r[2]>>10|r[3]<<1),t[s++]=d(r[3]>>7|r[4]<<4),t[s++]=d(r[4]>>4|r[5]<<7),t[s++]=d(r[5]>>1),t[s++]=d(r[5]>>9|r[6]<<2),t[s++]=d(r[6]>>6|r[7]<<5),t[s++]=d(r[7]>>3)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let s=0,o=0;o<256/8;o++){for(let i=0;i<8;i++)r[i]=d(((w(n[8*o+i])<<5)+w(3329/2))/w(3329))&31;t[s++]=d(r[0]>>0|r[1]<<5),t[s++]=d(r[1]>>3|r[2]<<2|r[3]<<7),t[s++]=d(r[3]>>1|r[4]<<4),t[s++]=d(r[4]>>4|r[5]<<1|r[6]<<6),t[s++]=d(r[6]>>2|r[7]<<3)}return t}_decompressU(t){let n=new Array(this._k);for(let s=0;s<this._k;s++)n[s]=new Array(384);let r=new Array(8);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/8;i++){r[0]=c(t[s+0])>>0|c(t[s+1])<<8,r[1]=c(t[s+1])>>3|c(t[s+2])<<5,r[2]=c(t[s+2])>>6|c(t[s+3])<<2|c(t[s+4])<<10,r[3]=c(t[s+4])>>1|c(t[s+5])<<7,r[4]=c(t[s+5])>>4|c(t[s+6])<<4,r[5]=c(t[s+6])>>7|c(t[s+7])<<1|c(t[s+8])<<9,r[6]=c(t[s+8])>>2|c(t[s+9])<<6,r[7]=c(t[s+9])>>5|c(t[s+10])<<3,s=s+11;for(let u=0;u<8;u++)n[o][8*i+u]=w(r[u]&2047)*3329+1024>>11}return n}_decompressV(t){let n=new Array(384),r=new Array(8);for(let s=0,o=0;o<256/8;o++){r[0]=t[s+0]>>0,r[1]=t[s+0]>>5|t[s+1]<<3,r[2]=t[s+1]>>2,r[3]=t[s+1]>>7|t[s+2]<<1,r[4]=t[s+2]>>4|t[s+3]<<4,r[5]=t[s+3]>>1,r[6]=t[s+3]>>6|t[s+4]<<2,r[7]=t[s+4]>>3,s=s+5;for(let i=0;i<8;i++)n[8*o+i]=k(w(r[i]&31)*w(3329)+16>>5)}return n}};export{ct as MlKem1024,it as MlKem512,ut as MlKem768,B as MlKemError};
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
