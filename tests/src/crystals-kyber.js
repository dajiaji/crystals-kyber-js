var k=class extends Error{constructor(t){let o;t instanceof Error?o=t.message:typeof t=="string"?o=t:o="",super(o),this.name=this.constructor.name}};var B=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],V=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441];function K(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function M(r,...t){if(!(r instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(r.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${r.length}`)}function R(r,t=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(t&&r.finished)throw new Error("Hash#digest() has already been called")}function Z(r,t){M(r);let o=t.outputLen;if(r.length<o)throw new Error(`digestInto() expects output buffer of length at least ${o}`)}var O=BigInt(4294967295),G=BigInt(32);function Ut(r,t=!1){return t?{h:Number(r&O),l:Number(r>>G&O)}:{h:Number(r>>G&O)|0,l:Number(r&O)|0}}function q(r,t=!1){let o=new Uint32Array(r.length),e=new Uint32Array(r.length);for(let n=0;n<r.length;n++){let{h:s,l:i}=Ut(r[n],t);[o[n],e[n]]=[s,i]}return[o,e]}var J=(r,t,o)=>r<<o|t>>>32-o,Y=(r,t,o)=>t<<o|r>>>32-o,tt=(r,t,o)=>t<<o-32|r>>>64-o,et=(r,t,o)=>r<<o-32|t>>>64-o;var Pt=r=>r instanceof Uint8Array;var rt=r=>new Uint32Array(r.buffer,r.byteOffset,Math.floor(r.byteLength/4));var Bt=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Bt)throw new Error("Non little-endian hardware is not supported");function Ot(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function T(r){if(typeof r=="string"&&(r=Ot(r)),!Pt(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}var E=class{clone(){return this._cloneInto()}},te={}.toString;function nt(r){let t=e=>r().update(T(e)).digest(),o=r();return t.outputLen=o.outputLen,t.blockLen=o.blockLen,t.create=()=>r(),t}function ot(r){let t=(e,n)=>r(n).update(T(e)).digest(),o=r({});return t.outputLen=o.outputLen,t.blockLen=o.blockLen,t.create=e=>r(e),t}var[ut,ct,at]=[[],[],[]],Et=BigInt(0),z=BigInt(1),Tt=BigInt(2),It=BigInt(7),Nt=BigInt(256),Ft=BigInt(113);for(let r=0,t=z,o=1,e=0;r<24;r++){[o,e]=[e,(2*o+3*e)%5],ut.push(2*(5*e+o)),ct.push((r+1)*(r+2)/2%64);let n=Et;for(let s=0;s<7;s++)t=(t<<z^(t>>It)*Ft)%Nt,t&Tt&&(n^=z<<(z<<BigInt(s))-z);at.push(n)}var[jt,Ht]=q(at,!0),st=(r,t,o)=>o>32?tt(r,t,o):J(r,t,o),it=(r,t,o)=>o>32?et(r,t,o):Y(r,t,o);function Vt(r,t=24){let o=new Uint32Array(10);for(let e=24-t;e<24;e++){for(let i=0;i<10;i++)o[i]=r[i]^r[i+10]^r[i+20]^r[i+30]^r[i+40];for(let i=0;i<10;i+=2){let u=(i+8)%10,p=(i+2)%10,w=o[p],c=o[p+1],L=st(w,c,1)^o[u],b=it(w,c,1)^o[u+1];for(let m=0;m<50;m+=10)r[i+m]^=L,r[i+m+1]^=b}let n=r[2],s=r[3];for(let i=0;i<24;i++){let u=ct[i],p=st(n,s,u),w=it(n,s,u),c=ut[i];n=r[c],s=r[c+1],r[c]=p,r[c+1]=w}for(let i=0;i<50;i+=10){for(let u=0;u<10;u++)o[u]=r[i+u];for(let u=0;u<10;u++)r[i+u]^=~o[(u+2)%10]&o[(u+4)%10]}r[0]^=jt[e],r[1]^=Ht[e]}o.fill(0)}var I=class r extends E{constructor(t,o,e,n=!1,s=24){if(super(),this.blockLen=t,this.suffix=o,this.outputLen=e,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,K(e),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=rt(this.state)}keccak(){Vt(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){R(this);let{blockLen:o,state:e}=this;t=T(t);let n=t.length;for(let s=0;s<n;){let i=Math.min(o-this.pos,n-s);for(let u=0;u<i;u++)e[this.pos++]^=t[s++];this.pos===o&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:o,pos:e,blockLen:n}=this;t[e]^=o,o&128&&e===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){R(this,!1),M(t),this.finish();let o=this.state,{blockLen:e}=this;for(let n=0,s=t.length;n<s;){this.posOut>=e&&this.keccak();let i=Math.min(e-this.posOut,s-n);t.set(o.subarray(this.posOut,this.posOut+i),n),this.posOut+=i,n+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return K(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Z(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:o,suffix:e,outputLen:n,rounds:s,enableXOF:i}=this;return t||(t=new r(o,e,n,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=e,t.outputLen=n,t.enableXOF=i,t.destroyed=this.destroyed,t}},g=(r,t,o)=>nt(()=>new I(t,r,o)),se=g(6,144,224/8),lt=g(6,136,256/8),ie=g(6,104,384/8),ft=g(6,72,512/8),ue=g(1,144,224/8),ce=g(1,136,256/8),ae=g(1,104,384/8),le=g(1,72,512/8),ht=(r,t,o)=>ot((e={})=>new I(t,r,e.dkLen===void 0?o:e.dkLen,!0)),pt=ht(31,168,128/8),N=ht(31,136,256/8);var Kt={},dt=Mt(globalThis,Kt);function Mt(r,t){return new Proxy(r,{get(o,e,n){return e in t?t[e]:r[e]},set(o,e,n){return e in t&&delete t[e],r[e]=n,!0},deleteProperty(o,e){let n=!1;return e in t&&(delete t[e],n=!0),e in r&&(delete r[e],n=!0),n},ownKeys(o){let e=Reflect.ownKeys(r),n=Reflect.ownKeys(t),s=new Set(n);return[...e.filter(i=>!s.has(i)),...n]},defineProperty(o,e,n){return e in t&&delete t[e],Reflect.defineProperty(r,e,n),!0},getOwnPropertyDescriptor(o,e){return e in t?Reflect.getOwnPropertyDescriptor(t,e):Reflect.getOwnPropertyDescriptor(r,e)},has(o,e){return e in t||e in r}})}function f(r){return r%256}function _(r){return r>=-32768&&r<=32767?r:r<-32768?(r=r+32769,r=r%65536,32767+r):(r=r-32768,r=r%65536,-32768+r)}function a(r){return r%65536}function F(r){return r>=-2147483648&&r<=2147483647?r:r<-2147483648?(r=r+2147483649,r=r%4294967296,2147483647+r):(r=r-2147483648,r=r%4294967296,-2147483648+r)}function y(r){return r%4294967296}function yt(r,t){if(r.length!=t.length)return 0;let o=new Uint8Array([0]);for(let n=0;n<r.length;n++)o[0]|=r[n]^t[n];let e=new Uint8Array([0]);return e[0]=~(o[0]^e[0]),e[0]&=e[0]>>4,e[0]&=e[0]>>2,e[0]&=e[0]>>1,e[0]}async function _t(){if(dt!==void 0&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:r}=await import("crypto");return r}catch{throw new Error("failed to load Crypto")}}function U(r,t,o){return N.create({dkLen:r}).update(t).update(new Uint8Array([o])).digest()}function wt(r){let t=y(r[0]);return t|=y(r[1])<<8,t|=y(r[2])<<16,t}function bt(r){let t=y(r[0]);return t|=y(r[1])<<8,t|=y(r[2])<<16,t|=y(r[3])<<24,y(t)}var S=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_skSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pkSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedUSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedVSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}async generateKeyPair(){await this._setup();try{let t=new Uint8Array(64);return this._api.getRandomValues(t),this._deriveKeyPair(t)}catch(t){throw new k(t)}}async deriveKeyPair(t){await this._setup();try{if(t.byteLength!==64)throw new Error("seed must be 64 bytes in length");return this._deriveKeyPair(t)}catch(o){throw new k(o)}}async encap(t,o){await this._setup();try{let e=v(this._getSeed(o)),[n,s]=C(e,v(t)),i=this._encap(t,e,s),u=X(n,v(i));return[i,u]}catch(e){throw new k(e)}}async decap(t,o){await this._setup();try{if(t.byteLength!==this._compressedUSize+this._compressedVSize)throw new Error("Invalid ct size");let e=o.subarray(0,this._skSize),n=o.subarray(this._skSize,this._skSize+this._pkSize),s=o.subarray(this._skSize+this._pkSize,this._skSize+this._pkSize+32),i=o.subarray(this._skSize+this._pkSize+32,this._skSize+this._pkSize+64),u=this._decap(t,e),[p,w]=C(u,s),c=this._encap(n,u,w);return yt(t,c)==1?X(p,v(t)):X(i,v(t))}catch(e){throw new k(e)}}async _setup(){this._api===void 0&&(this._api=await _t())}_getSeed(t){if(t==null){let o=new Uint8Array(32);return this._api.getRandomValues(o),o}if(t.byteLength!==32)throw new Error("seed must be 32 bytes in length");return t}_deriveKeyPair(t){let o=t.subarray(0,32),e=t.subarray(32,64),[n,s]=this._deriveCpaKeyPair(o),i=v(n),u=new Uint8Array(this._skSize+this._pkSize+64);return u.set(s,0),u.set(n,this._skSize),u.set(i,this._skSize+this._pkSize),u.set(e,this._skSize+this._pkSize+32),[n,u]}_deriveCpaKeyPair(t){let[o,e]=C(t),n=this._sampleMatrix(o,!1),s=this._sampleNoise1(e,0,this._k),i=this._sampleNoise1(e,this._k,this._k);for(let c=0;c<this._k;c++)s[c]=j(s[c]),s[c]=A(s[c]),i[c]=j(i[c]);let u=new Array(this._k);for(let c=0;c<this._k;c++)u[c]=Qt(H(n[c],s)),u[c]=P(u[c],i[c]),u[c]=A(u[c]);let p=new Uint8Array(this._pkSize);for(let c=0;c<this._k;c++)p.set(mt(u[c]),c*384);p.set(o,this._skSize);let w=new Uint8Array(this._skSize);for(let c=0;c<this._k;c++)w.set(mt(s[c]),c*384);return[p,w]}_encap(t,o,e){let n=new Array(this._k);for(let h=0;h<this._k;h++)n[h]=kt(t.subarray(h*384,(h+1)*384));let s=t.subarray(this._skSize),i=this._sampleMatrix(s,!0),u=this._sampleNoise1(e,0,this._k),p=this._sampleNoise2(e,this._k,this._k),w=this._sampleNoise2(e,this._k*2,1)[0];for(let h=0;h<this._k;h++)u[h]=j(u[h]),u[h]=A(u[h]);let c=new Array(this._k);for(let h=0;h<this._k;h++)c[h]=H(i[h],u),c[h]=$(c[h]),c[h]=P(c[h],p[h]),c[h]=A(c[h]);let L=Dt(o),b=H(n,u);b=$(b),b=P(b,w),b=P(b,L),b=A(b);let m=new Uint8Array(this._compressedUSize+this._compressedVSize);return this._compressU(m.subarray(0,this._compressedUSize),c),this._compressV(m.subarray(this._compressedUSize),b),m}_decap(t,o){let e=this._decompressU(t.subarray(0,this._compressedUSize)),n=this._decompressV(t.subarray(this._compressedUSize)),s=this._polyvecFromBytes(o);for(let u=0;u<this._k;u++)e[u]=j(e[u]);let i=H(s,e);return i=$(i),i=Wt(n,i),i=A(i),$t(i)}_sampleMatrix(t,o){let e=new Array(this._k),n=new Uint8Array(2);for(let s=0,i=0;i<this._k;i++){e[i]=new Array(this._k);for(let u=0;u<this._k;u++){o?(n[0]=i,n[1]=u):(n[0]=u,n[1]=i);let p=Xt(t,n),w=gt(p.subarray(0,504),504,256);for(e[i][u]=w[0],s=w[1];s<256;){let c=p.subarray(504,672),L=gt(c,168,256-s),b=L[0],m=L[1];for(let h=s;h<256;h++)e[i][u][h]=b[h-s];s=s+m}}}return e}_sampleNoise1(t,o,e){let n=new Array(e);for(let s=0;s<e;s++)n[s]=xt(U(this._eta1*256/4,t,o),this._eta1),o++;return n}_sampleNoise2(t,o,e){let n=new Array(e);for(let s=0;s<e;s++)n[s]=xt(U(this._eta2*256/4,t,o),this._eta2),o++;return n}_polyvecFromBytes(t){let o=new Array(this._k);for(let e=0;e<this._k;e++)o[e]=kt(t.subarray(e*384,(e+1)*384));return o}_compressU(t,o){let e=new Array(4);for(let n=0,s=0;s<this._k;s++)for(let i=0;i<256/4;i++){for(let u=0;u<4;u++)e[u]=((o[s][4*i+u]<<10)+3329/2)/3329&1023;t[n++]=f(e[0]>>0),t[n++]=f(e[0]>>8|e[1]<<2),t[n++]=f(e[1]>>6|e[2]<<4),t[n++]=f(e[2]>>4|e[3]<<6),t[n++]=f(e[3]>>2)}return t}_compressV(t,o){let e=new Uint8Array(8);for(let n=0,s=0;s<256/8;s++){for(let i=0;i<8;i++)e[i]=f(((o[8*s+i]<<4)+3329/2)/3329)&15;t[n++]=e[0]|e[1]<<4,t[n++]=e[2]|e[3]<<4,t[n++]=e[4]|e[5]<<4,t[n++]=e[6]|e[7]<<4}return t}_decompressU(t){let o=new Array(this._k);for(let n=0;n<this._k;n++)o[n]=new Array(384);let e=new Array(4);for(let n=0,s=0;s<this._k;s++)for(let i=0;i<256/4;i++){e[0]=a(t[n+0])>>0|a(t[n+1])<<8,e[1]=a(t[n+1])>>2|a(t[n+2])<<6,e[2]=a(t[n+2])>>4|a(t[n+3])<<4,e[3]=a(t[n+3])>>6|a(t[n+4])<<2,n=n+5;for(let u=0;u<4;u++)o[s][4*i+u]=_(y(e[u]&1023)*y(3329)+512>>10)}return o}_decompressV(t){let o=new Array(384);for(let e=0,n=0;n<256/2;n++,e++)o[2*n+0]=_(a(t[e]&15)*a(3329)+8>>4),o[2*n+1]=_(a(t[e]>>4)*a(3329)+8>>4);return o}};function C(r,t){let o=ft.create().update(r);t!==void 0&&o.update(t);let e=o.digest();return[e.subarray(0,32),e.subarray(32,64)]}function v(r){return lt.create().update(r).digest()}function X(r,t){let o=N.create({dkLen:32}).update(r);return t!==void 0&&o.update(t),o.digest()}function Xt(r,t){return pt.create({dkLen:672}).update(r).update(t).digest()}function mt(r){let t=0,o=0,e=new Uint8Array(384),n=zt(r);for(let s=0;s<256/2;s++)t=a(n[2*s]),o=a(n[2*s+1]),e[3*s+0]=f(t>>0),e[3*s+1]=f(t>>8)|f(o<<4),e[3*s+2]=f(o>>4);return e}function kt(r){let t=new Array(384).fill(0);for(let o=0;o<256/2;o++)t[2*o]=_((a(r[3*o+0])>>0|a(r[3*o+1])<<8)&4095),t[2*o+1]=_((a(r[3*o+1])>>4|a(r[3*o+2])<<4)&4095);return t}function $t(r){let t=new Uint8Array(32),o,e=zt(r);for(let n=0;n<256/8;n++){t[n]=0;for(let s=0;s<8;s++)o=((a(e[8*n+s])<<1)+a(3329/2))/a(3329)&1,t[n]|=f(o<<s)}return t}function Dt(r){let t=new Array(384).fill(0),o;for(let e=0;e<256/8;e++)for(let n=0;n<8;n++)o=-1*_(r[e]>>n&1),t[8*e+n]=o&_((3329+1)/2);return t}function gt(r,t,o){let e=new Array(384).fill(0),n=0,s,i;for(let u=0;n<o&&u+3<=t;)s=(a(r[u]>>0)|a(r[u+1])<<8)&4095,i=(a(r[u+1]>>4)|a(r[u+2])<<4)&4095,u=u+3,s<3329&&(e[n]=s,n=n+1),n<o&&i<3329&&(e[n]=i,n=n+1);return[e,n]}function xt(r,t){let o,e,n,s,i=new Array(384).fill(0);for(let u=0;u<256/8;u++){o=bt(r.subarray(4*u,r.length)),e=o&1431655765,e=e+(o>>1&1431655765);for(let p=0;p<8;p++)n=_(e>>4*p+0&3),s=_(e>>4*p+t&3),i[8*u+p]=n-s}return i}function j(r){for(let t=0,o=1,e=128;e>=2;e>>=1)for(let n=0;n<256;n=t+e){let s=B[o];for(o=o+1,t=n;t<n+e;t++){let i=x(s,r[t+e]);r[t+e]=r[t]-i,r[t]=r[t]+i}}return r}function x(r,t){return vt(r*t)}function A(r){for(let t=0;t<256;t++)r[t]=Lt(r[t]);return r}function Lt(r){let o=(16777216+3329/2)/3329*r>>24;return o=o*3329,r-o}function vt(r){let o=_(F(r)*62209)*3329;return o=r-o,o>>=16,_(o)}function Qt(r){for(let o=0;o<256;o++)r[o]=vt(F(r[o])*F(1353));return r}function H(r,t){let o=St(r[0],t[0]),e;for(let n=1;n<r.length;n++)e=St(r[n],t[n]),o=P(o,e);return A(o)}function St(r,t){let o,e;for(let n=0;n<256/4;n++)o=At(r[4*n+0],r[4*n+1],t[4*n+0],t[4*n+1],B[64+n]),e=At(r[4*n+2],r[4*n+3],t[4*n+2],t[4*n+3],-B[64+n]),r[4*n+0]=o[0],r[4*n+1]=o[1],r[4*n+2]=e[0],r[4*n+3]=e[1];return r}function At(r,t,o,e,n){let s=new Array(2);return s[0]=x(t,e),s[0]=x(s[0],n),s[0]+=x(r,o),s[1]=x(r,e),s[1]+=x(t,o),s}function P(r,t){let o=new Array(384);for(let e=0;e<256;e++)o[e]=r[e]+t[e];return o}function Wt(r,t){for(let o=0;o<256;o++)r[o]-=t[o];return r}function $(r){let t=0;for(let o=0,e=2;e<=128;e<<=1)for(let n=0;n<256;n=t+e){let s=V[o];for(o=o+1,t=n;t<n+e;t++){let i=r[t];r[t]=Lt(i+r[t+e]),r[t+e]=i-r[t+e],r[t+e]=x(s,r[t+e])}}for(t=0;t<256;t++)r[t]=x(r[t],V[127]);return r}function zt(r){for(let t=0;t<256;t++)r[t]-=3329,r[t]+=r[t]>>31&3329;return r}var D=class extends S{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_sampleNoise1(t,o,e){let n=new Array(e);for(let s=0;s<e;s++)n[s]=Zt(U(this._eta1*256/4,t,o),this._eta1),o++;return n}};function Zt(r,t){let o,e,n,s,i=new Array(384).fill(0);for(let u=0;u<256/4;u++){o=wt(r.subarray(3*u,r.length)),e=o&2396745,e=e+(o>>1&2396745),e=e+(o>>2&2396745);for(let p=0;p<4;p++)n=_(e>>6*p+0&7),s=_(e>>6*p+t&7),i[4*u+p]=n-s}return i}var Q=class extends S{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}};var W=class extends S{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:11}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_compressU(t,o){let e=new Array(8);for(let n=0,s=0;s<this._k;s++)for(let i=0;i<256/8;i++){for(let u=0;u<8;u++)e[u]=a(((y(o[s][8*i+u])<<11)+y(3329/2))/y(3329)&2047);t[n++]=f(e[0]>>0),t[n++]=f(e[0]>>8|e[1]<<3),t[n++]=f(e[1]>>5|e[2]<<6),t[n++]=f(e[2]>>2),t[n++]=f(e[2]>>10|e[3]<<1),t[n++]=f(e[3]>>7|e[4]<<4),t[n++]=f(e[4]>>4|e[5]<<7),t[n++]=f(e[5]>>1),t[n++]=f(e[5]>>9|e[6]<<2),t[n++]=f(e[6]>>6|e[7]<<5),t[n++]=f(e[7]>>3)}return t}_compressV(t,o){let e=new Uint8Array(8);for(let n=0,s=0;s<256/8;s++){for(let i=0;i<8;i++)e[i]=f(((y(o[8*s+i])<<5)+y(3329/2))/y(3329))&31;t[n++]=f(e[0]>>0|e[1]<<5),t[n++]=f(e[1]>>3|e[2]<<2|e[3]<<7),t[n++]=f(e[3]>>1|e[4]<<4),t[n++]=f(e[4]>>4|e[5]<<1|e[6]<<6),t[n++]=f(e[6]>>2|e[7]<<3)}return t}_decompressU(t){let o=new Array(this._k);for(let n=0;n<this._k;n++)o[n]=new Array(384);let e=new Array(8);for(let n=0,s=0;s<this._k;s++)for(let i=0;i<256/8;i++){e[0]=a(t[n+0])>>0|a(t[n+1])<<8,e[1]=a(t[n+1])>>3|a(t[n+2])<<5,e[2]=a(t[n+2])>>6|a(t[n+3])<<2|a(t[n+4])<<10,e[3]=a(t[n+4])>>1|a(t[n+5])<<7,e[4]=a(t[n+5])>>4|a(t[n+6])<<4,e[5]=a(t[n+6])>>7|a(t[n+7])<<1|a(t[n+8])<<9,e[6]=a(t[n+8])>>2|a(t[n+9])<<6,e[7]=a(t[n+9])>>5|a(t[n+10])<<3,n=n+11;for(let u=0;u<8;u++)o[s][8*i+u]=y(e[u]&2047)*3329+1024>>11}return o}_decompressV(t){let o=new Array(384),e=new Array(8);for(let n=0,s=0;s<256/8;s++){e[0]=t[n+0]>>0,e[1]=t[n+0]>>5|t[n+1]<<3,e[2]=t[n+1]>>2,e[3]=t[n+1]>>7|t[n+2]<<1,e[4]=t[n+2]>>4|t[n+3]<<4,e[5]=t[n+3]>>1,e[6]=t[n+3]>>6|t[n+4]<<2,e[7]=t[n+4]>>3,n=n+5;for(let i=0;i<8;i++)o[8*s+i]=_(y(e[i]&31)*y(3329)+16>>5)}return o}};export{W as Kyber1024,D as Kyber512,Q as Kyber768,k as KyberError};
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
