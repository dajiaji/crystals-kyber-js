var ae=Object.create;var ut=Object.defineProperty;var le=Object.getOwnPropertyDescriptor;var fe=Object.getOwnPropertyNames;var he=Object.getPrototypeOf,pe=Object.prototype.hasOwnProperty;var M=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var de=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of fe(t))!pe.call(e,o)&&o!==n&&ut(e,o,{get:()=>t[o],enumerable:!(r=le(t,o))||r.enumerable});return e};var ye=(e,t,n)=>(n=e!=null?ae(he(e)):{},de(t||!e||!e.__esModule?ut(n,"default",{value:e,enumerable:!0}):n,e));var Ht=M(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.toBig=l.shrSL=l.shrSH=l.rotrSL=l.rotrSH=l.rotrBL=l.rotrBH=l.rotr32L=l.rotr32H=l.rotlSL=l.rotlSH=l.rotlBL=l.rotlBH=l.add5L=l.add5H=l.add4L=l.add4H=l.add3L=l.add3H=void 0;l.add=St;l.fromBig=G;l.split=ct;var C=BigInt(2**32-1),Z=BigInt(32);function G(e,t=!1){return t?{h:Number(e&C),l:Number(e>>Z&C)}:{h:Number(e>>Z&C)|0,l:Number(e&C)|0}}function ct(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){let{h:i,l:u}=G(e[s],t);[r[s],o[s]]=[i,u]}return[r,o]}var at=(e,t)=>BigInt(e>>>0)<<Z|BigInt(t>>>0);l.toBig=at;var lt=(e,t,n)=>e>>>n;l.shrSH=lt;var ft=(e,t,n)=>e<<32-n|t>>>n;l.shrSL=ft;var ht=(e,t,n)=>e>>>n|t<<32-n;l.rotrSH=ht;var pt=(e,t,n)=>e<<32-n|t>>>n;l.rotrSL=pt;var dt=(e,t,n)=>e<<64-n|t>>>n-32;l.rotrBH=dt;var yt=(e,t,n)=>e>>>n-32|t<<64-n;l.rotrBL=yt;var _t=(e,t)=>t;l.rotr32H=_t;var wt=(e,t)=>e;l.rotr32L=wt;var bt=(e,t,n)=>e<<n|t>>>32-n;l.rotlSH=bt;var kt=(e,t,n)=>t<<n|e>>>32-n;l.rotlSL=kt;var mt=(e,t,n)=>t<<n-32|e>>>64-n;l.rotlBH=mt;var gt=(e,t,n)=>e<<n-32|t>>>64-n;l.rotlBL=gt;function St(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var xt=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);l.add3L=xt;var At=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;l.add3H=At;var Lt=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);l.add4L=Lt;var Bt=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0;l.add4H=Bt;var vt=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0);l.add5L=vt;var Ut=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;l.add5H=Ut;var _e={fromBig:G,split:ct,toBig:at,shrSH:lt,shrSL:ft,rotrSH:ht,rotrSL:pt,rotrBH:dt,rotrBL:yt,rotr32H:_t,rotr32L:wt,rotlSH:bt,rotlSL:kt,rotlBH:mt,rotlBL:gt,add:St,add3L:xt,add3H:At,add4L:Lt,add4H:Bt,add5H:Ut,add5L:vt};l.default=_e});var zt=M(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.crypto=void 0;R.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Nt=M(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.wrapXOFConstructorWithOpts=c.wrapConstructorWithOpts=c.wrapConstructor=c.Hash=c.nextTick=c.swap32IfBE=c.byteSwapIfBE=c.swap8IfBE=c.isLE=void 0;c.isBytes=Tt;c.anumber=J;c.abytes=P;c.ahash=we;c.aexists=be;c.aoutput=ke;c.u8=me;c.u32=ge;c.clean=Se;c.createView=xe;c.rotr=Ae;c.rotl=Le;c.byteSwap=$;c.byteSwap32=Pt;c.bytesToHex=ve;c.hexToBytes=Ue;c.asyncLoop=ze;c.utf8ToBytes=tt;c.bytesToUtf8=Oe;c.toBytes=X;c.kdfInputToBytes=Te;c.concatBytes=Pe;c.checkOpts=Ie;c.createHasher=Et;c.createOptHasher=Ft;c.createXOFer=jt;c.randomBytes=Ee;var T=zt();function Tt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function J(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function P(e,...t){if(!Tt(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function we(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");J(e.outputLen),J(e.blockLen)}function be(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ke(e,t){P(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function me(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function ge(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Se(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function xe(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ae(e,t){return e<<32-t|e>>>t}function Le(e,t){return e<<t|e>>>32-t>>>0}c.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function $(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}c.swap8IfBE=c.isLE?e=>e:e=>$(e);c.byteSwapIfBE=c.swap8IfBE;function Pt(e){for(let t=0;t<e.length;t++)e[t]=$(e[t]);return e}c.swap32IfBE=c.isLE?e=>e:Pt;var It=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Be=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ve(e){if(P(e),It)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Be[e[n]];return t}var L={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ot(e){if(e>=L._0&&e<=L._9)return e-L._0;if(e>=L.A&&e<=L.F)return e-(L.A-10);if(e>=L.a&&e<=L.f)return e-(L.a-10)}function Ue(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(It)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=Ot(e.charCodeAt(s)),u=Ot(e.charCodeAt(s+1));if(i===void 0||u===void 0){let p=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+s)}r[o]=i*16+u}return r}var He=async()=>{};c.nextTick=He;async function ze(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let s=Date.now()-r;s>=0&&s<t||(await(0,c.nextTick)(),r+=s)}}function tt(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function Oe(e){return new TextDecoder().decode(e)}function X(e){return typeof e=="string"&&(e=tt(e)),P(e),e}function Te(e){return typeof e=="string"&&(e=tt(e)),P(e),e}function Pe(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];P(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}function Ie(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(e,t)}var Y=class{};c.Hash=Y;function Et(e){let t=r=>e().update(X(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ft(e){let t=(r,o)=>e(o).update(X(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function jt(e){let t=(r,o)=>e(o).update(X(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}c.wrapConstructor=Et;c.wrapConstructorWithOpts=Ft;c.wrapXOFConstructorWithOpts=jt;function Ee(e=32){if(T.crypto&&typeof T.crypto.getRandomValues=="function")return T.crypto.getRandomValues(new Uint8Array(e));if(T.crypto&&typeof T.crypto.randomBytes=="function")return Uint8Array.from(T.crypto.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}});var Qt=M(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.shake256=_.shake128=_.keccak_512=_.keccak_384=_.keccak_256=_.keccak_224=_.sha3_512=_.sha3_384=_.sha3_256=_.sha3_224=_.Keccak=void 0;_.keccakP=Dt;var F=Ht(),g=Nt(),Fe=BigInt(0),E=BigInt(1),je=BigInt(2),Ne=BigInt(7),Ve=BigInt(256),Me=BigInt(113),Kt=[],Ct=[],Rt=[];for(let e=0,t=E,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],Kt.push(2*(5*r+n)),Ct.push((e+1)*(e+2)/2%64);let o=Fe;for(let s=0;s<7;s++)t=(t<<E^(t>>Ne)*Me)%Ve,t&je&&(o^=E<<(E<<BigInt(s))-E);Rt.push(o)}var Xt=(0,F.split)(Rt,!0),Ke=Xt[0],Ce=Xt[1],Vt=(e,t,n)=>n>32?(0,F.rotlBH)(e,t,n):(0,F.rotlSH)(e,t,n),Mt=(e,t,n)=>n>32?(0,F.rotlBL)(e,t,n):(0,F.rotlSL)(e,t,n);function Dt(e,t=24){let n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let u=(i+8)%10,p=(i+2)%10,x=n[p],f=n[p+1],S=Vt(x,f,1)^n[u],I=Mt(x,f,1)^n[u+1];for(let m=0;m<50;m+=10)e[i+m]^=S,e[i+m+1]^=I}let o=e[2],s=e[3];for(let i=0;i<24;i++){let u=Ct[i],p=Vt(o,s,u),x=Mt(o,s,u),f=Kt[i];o=e[f],s=e[f+1],e[f]=p,e[f+1]=x}for(let i=0;i<50;i+=10){for(let u=0;u<10;u++)n[u]=e[i+u];for(let u=0;u<10;u++)e[i+u]^=~n[(u+2)%10]&n[(u+4)%10]}e[0]^=Ke[r],e[1]^=Ce[r]}(0,g.clean)(n)}var j=class e extends g.Hash{constructor(t,n,r,o=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=o,this.rounds=s,(0,g.anumber)(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,g.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,g.swap32IfBE)(this.state32),Dt(this.state32,this.rounds),(0,g.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(t){(0,g.aexists)(this),t=(0,g.toBytes)(t),(0,g.abytes)(t);let{blockLen:n,state:r}=this,o=t.length;for(let s=0;s<o;){let i=Math.min(n-this.pos,o-s);for(let u=0;u<i;u++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:r,blockLen:o}=this;t[r]^=n,(n&128)!==0&&r===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){(0,g.aexists)(this,!1),(0,g.abytes)(t),this.finish();let n=this.state,{blockLen:r}=this;for(let o=0,s=t.length;o<s;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,s-o);t.set(n.subarray(this.posOut,this.posOut+i),o),this.posOut+=i,o+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,g.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,g.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,g.clean)(this.state)}_cloneInto(t){let{blockLen:n,suffix:r,outputLen:o,rounds:s,enableXOF:i}=this;return t||(t=new e(n,r,o,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=o,t.enableXOF=i,t.destroyed=this.destroyed,t}};_.Keccak=j;var U=(e,t,n)=>(0,g.createHasher)(()=>new j(t,e,n));_.sha3_224=U(6,144,224/8);_.sha3_256=U(6,136,256/8);_.sha3_384=U(6,104,384/8);_.sha3_512=U(6,72,512/8);_.keccak_224=U(1,144,224/8);_.keccak_256=U(1,136,256/8);_.keccak_384=U(1,104,384/8);_.keccak_512=U(1,72,512/8);var qt=(e,t,n)=>(0,g.createXOFer)((r={})=>new j(t,e,r.dkLen===void 0?n:r.dkLen,!0));_.shake128=qt(31,168,128/8);_.shake256=qt(31,136,256/8)});var v=class extends Error{constructor(t){let n;t instanceof Error?n=t.message:typeof t=="string"?n=t:n="",super(n),this.name=this.constructor.name}};var K=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],W=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441];var A=ye(Qt(),1);var Re={},Wt=Xe(globalThis,Re);function Xe(e,t){return new Proxy(e,{get(n,r,o){return r in t?t[r]:e[r]},set(n,r,o){return r in t&&delete t[r],e[r]=o,!0},deleteProperty(n,r){let o=!1;return r in t&&(delete t[r],o=!0),r in e&&(delete e[r],o=!0),o},ownKeys(n){let r=Reflect.ownKeys(e),o=Reflect.ownKeys(t),s=new Set(o);return[...r.filter(i=>!s.has(i)),...o]},defineProperty(n,r,o){return r in t&&delete t[r],Reflect.defineProperty(e,r,o),!0},getOwnPropertyDescriptor(n,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(n,r){return r in t||r in e}})}function d(e){return e%256}function k(e){return e>=-32768&&e<=32767?e:e<-32768?(e=e+32769,e=e%65536,32767+e):(e=e-32768,e=e%65536,-32768+e)}function a(e){return e%65536}function D(e){return e>=-2147483648&&e<=2147483647?e:e<-2147483648?(e=e+2147483649,e=e%4294967296,2147483647+e):(e=e-2147483648,e=e%4294967296,-2147483648+e)}function b(e){return e%4294967296}function Zt(e,t){if(e.length!=t.length)return 0;let n=new Uint8Array([0]);for(let o=0;o<e.length;o++)n[0]|=e[o]^t[o];let r=new Uint8Array([0]);return r[0]=~(n[0]^r[0]),r[0]&=r[0]>>4,r[0]&=r[0]>>2,r[0]&=r[0]>>1,r[0]}function Gt(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}async function Jt(){if(typeof Wt<"u"&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:e}=await import("crypto");return e}catch{throw new Error("failed to load Crypto")}}function N(e,t,n){return A.shake256.create({dkLen:e}).update(t).update(new Uint8Array([n])).digest()}function Yt(e){let t=b(e[0]);return t|=b(e[1])<<8,t|=b(e[2])<<16,t}function $t(e){let t=b(e[0]);return t|=b(e[1])<<8,t|=b(e[2])<<16,t|=b(e[3])<<24,b(t)}var z=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_skSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pkSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedUSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedVSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}async generateKeyPair(){await this._setup();try{let t=new Uint8Array(64);return this._api.getRandomValues(t),this._deriveKeyPair(t)}catch(t){throw new v(t)}}async deriveKeyPair(t){await this._setup();try{if(t.byteLength!==64)throw new Error("seed must be 64 bytes in length");return this._deriveKeyPair(t)}catch(n){throw new v(n)}}async encap(t,n){await this._setup();try{if(t.length!==384*this._k+32)throw new Error("invalid encapsulation key");let r=this._getSeed(n),[o,s]=et(r,te(t));return[this._encap(t,r,s),o]}catch(r){throw new v(r)}}async decap(t,n){await this._setup();try{if(t.byteLength!==this._compressedUSize+this._compressedVSize)throw new Error("Invalid ct size");if(n.length!==768*this._k+96)throw new Error("Invalid decapsulation key");let r=n.subarray(0,this._skSize),o=n.subarray(this._skSize,this._skSize+this._pkSize),s=n.subarray(this._skSize+this._pkSize,this._skSize+this._pkSize+32),i=n.subarray(this._skSize+this._pkSize+32,this._skSize+this._pkSize+64),u=this._decap(t,r),[p,x]=et(u,s),f=Qe(i,t),S=this._encap(o,u,x);return Zt(t,S)===1?p:f}catch(r){throw new v(r)}}async _setup(){this._api===void 0&&(this._api=await Jt())}_getSeed(t){if(t==null){let n=new Uint8Array(32);return this._api.getRandomValues(n),n}if(t.byteLength!==32)throw new Error("seed must be 32 bytes in length");return t}_deriveKeyPair(t){let n=t.subarray(0,32),r=t.subarray(32,64),[o,s]=this._deriveCpaKeyPair(n),i=te(o),u=new Uint8Array(this._skSize+this._pkSize+64);return u.set(s,0),u.set(o,this._skSize),u.set(i,this._skSize+this._pkSize),u.set(r,this._skSize+this._pkSize+32),[o,u]}_deriveCpaKeyPair(t){let[n,r]=et(t,new Uint8Array([this._k])),o=this._sampleMatrix(n,!1),s=this._sampleNoise1(r,0,this._k),i=this._sampleNoise1(r,this._k,this._k);for(let f=0;f<this._k;f++)s[f]=q(s[f]),s[f]=O(s[f]),i[f]=q(i[f]);let u=new Array(this._k);for(let f=0;f<this._k;f++)u[f]=Je(Q(o[f],s)),u[f]=V(u[f],i[f]),u[f]=O(u[f]);let p=new Uint8Array(this._pkSize);for(let f=0;f<this._k;f++)p.set(rt(u[f]),f*384);p.set(n,this._skSize);let x=new Uint8Array(this._skSize);for(let f=0;f<this._k;f++)x.set(rt(s[f]),f*384);return[p,x]}_encap(t,n,r){let o=new Array(this._k),s=new Uint8Array(384*this._k);for(let y=0;y<this._k;y++)o[y]=ee(t.subarray(y*384,(y+1)*384)),s.set(rt(o[y]),y*384);if(!Gt(t.subarray(0,s.length),s))throw new Error("invalid encapsulation key");let i=t.subarray(this._skSize),u=this._sampleMatrix(i,!0),p=this._sampleNoise1(r,0,this._k),x=this._sampleNoise2(r,this._k,this._k),f=this._sampleNoise2(r,this._k*2,1)[0];for(let y=0;y<this._k;y++)p[y]=q(p[y]),p[y]=O(p[y]);let S=new Array(this._k);for(let y=0;y<this._k;y++)S[y]=Q(u[y],p),S[y]=nt(S[y]),S[y]=V(S[y],x[y]),S[y]=O(S[y]);let I=Ge(n),m=Q(o,p);m=nt(m),m=V(m,f),m=V(m,I),m=O(m);let B=new Uint8Array(this._compressedUSize+this._compressedVSize);return this._compressU(B.subarray(0,this._compressedUSize),S),this._compressV(B.subarray(this._compressedUSize),m),B}_decap(t,n){let r=this._decompressU(t.subarray(0,this._compressedUSize)),o=this._decompressV(t.subarray(this._compressedUSize)),s=this._polyvecFromBytes(n);for(let u=0;u<this._k;u++)r[u]=q(r[u]);let i=Q(s,r);return i=nt(i),i=Ye(o,i),i=O(i),Ze(i)}_sampleMatrix(t,n){let r=new Array(this._k),o=new Uint8Array(2);for(let s=0,i=0;i<this._k;i++){r[i]=new Array(this._k);for(let u=0;u<this._k;u++){n?(o[0]=i,o[1]=u):(o[0]=u,o[1]=i);let p=We(t,o),x=re(p.subarray(0,504),504,256);for(r[i][u]=x[0],s=x[1];s<256;){let f=p.subarray(504,672),S=re(f,168,256-s),I=S[0],m=S[1];for(let B=s;B<256;B++)r[i][u][B]=I[B-s];s=s+m}}}return r}_sampleNoise1(t,n,r){let o=new Array(r);for(let s=0;s<r;s++)o[s]=ne(N(this._eta1*256/4,t,n),this._eta1),n++;return o}_sampleNoise2(t,n,r){let o=new Array(r);for(let s=0;s<r;s++)o[s]=ne(N(this._eta2*256/4,t,n),this._eta2),n++;return o}_polyvecFromBytes(t){let n=new Array(this._k);for(let r=0;r<this._k;r++)n[r]=ee(t.subarray(r*384,(r+1)*384));return n}_compressU(t,n){let r=new Array(4);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/4;i++){for(let u=0;u<4;u++)r[u]=((n[s][4*i+u]<<10)+3329/2)/3329&1023;t[o++]=d(r[0]>>0),t[o++]=d(r[0]>>8|r[1]<<2),t[o++]=d(r[1]>>6|r[2]<<4),t[o++]=d(r[2]>>4|r[3]<<6),t[o++]=d(r[3]>>2)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let o=0,s=0;s<256/8;s++){for(let i=0;i<8;i++)r[i]=d(((n[8*s+i]<<4)+3329/2)/3329)&15;t[o++]=r[0]|r[1]<<4,t[o++]=r[2]|r[3]<<4,t[o++]=r[4]|r[5]<<4,t[o++]=r[6]|r[7]<<4}return t}_decompressU(t){let n=new Array(this._k);for(let o=0;o<this._k;o++)n[o]=new Array(384);let r=new Array(4);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/4;i++){r[0]=a(t[o+0])>>0|a(t[o+1])<<8,r[1]=a(t[o+1])>>2|a(t[o+2])<<6,r[2]=a(t[o+2])>>4|a(t[o+3])<<4,r[3]=a(t[o+3])>>6|a(t[o+4])<<2,o=o+5;for(let u=0;u<4;u++)n[s][4*i+u]=k(b(r[u]&1023)*b(3329)+512>>10)}return n}_decompressV(t){let n=new Array(384);for(let r=0,o=0;o<256/2;o++,r++)n[2*o+0]=k(a(t[r]&15)*a(3329)+8>>4),n[2*o+1]=k(a(t[r]>>4)*a(3329)+8>>4);return n}};function et(e,t){let n=A.sha3_512.create().update(e);t!==void 0&&n.update(t);let r=n.digest();return[r.subarray(0,32),r.subarray(32,64)]}function te(e){return A.sha3_256.create().update(e).digest()}function Qe(e,t){let n=A.shake256.create({dkLen:32}).update(e);return t!==void 0&&n.update(t),n.digest()}function We(e,t){return A.shake128.create({dkLen:672}).update(e).update(t).digest()}function rt(e){let t=0,n=0,r=new Uint8Array(384),o=ce(e);for(let s=0;s<256/2;s++)t=a(o[2*s]),n=a(o[2*s+1]),r[3*s+0]=d(t>>0),r[3*s+1]=d(t>>8)|d(n<<4),r[3*s+2]=d(n>>4);return r}function ee(e){let t=new Array(384).fill(0);for(let n=0;n<256/2;n++)t[2*n]=k((a(e[3*n+0])>>0|a(e[3*n+1])<<8)&4095),t[2*n+1]=k((a(e[3*n+1])>>4|a(e[3*n+2])<<4)&4095);return t}function Ze(e){let t=new Uint8Array(32),n,r=ce(e);for(let o=0;o<256/8;o++){t[o]=0;for(let s=0;s<8;s++)n=((a(r[8*o+s])<<1)+a(3329/2))/a(3329)&1,t[o]|=d(n<<s)}return t}function Ge(e){let t=new Array(384).fill(0),n;for(let r=0;r<256/8;r++)for(let o=0;o<8;o++)n=-1*k(e[r]>>o&1),t[8*r+o]=n&k(3330/2);return t}function re(e,t,n){let r=new Array(384).fill(0),o=0,s,i;for(let u=0;o<n&&u+3<=t;)s=(a(e[u]>>0)|a(e[u+1])<<8)&4095,i=(a(e[u+1]>>4)|a(e[u+2])<<4)&4095,u=u+3,s<3329&&(r[o]=s,o=o+1),o<n&&i<3329&&(r[o]=i,o=o+1);return[r,o]}function ne(e,t){let n,r,o,s,i=new Array(384).fill(0);for(let u=0;u<256/8;u++){n=$t(e.subarray(4*u,e.length)),r=n&1431655765,r=r+(n>>1&1431655765);for(let p=0;p<8;p++)o=k(r>>4*p+0&3),s=k(r>>4*p+t&3),i[8*u+p]=o-s}return i}function q(e){for(let t=0,n=1,r=128;r>=2;r>>=1)for(let o=0;o<256;o=t+r){let s=K[n];for(n=n+1,t=o;t<o+r;t++){let i=H(s,e[t+r]);e[t+r]=e[t]-i,e[t]=e[t]+i}}return e}function H(e,t){return ue(e*t)}function O(e){for(let t=0;t<256;t++)e[t]=ie(e[t]);return e}function ie(e){let n=(16777216+3329/2)/3329*e>>24;return n=n*3329,e-n}function ue(e){let n=k(D(e)*62209)*3329;return n=e-n,n>>=16,k(n)}function Je(e){for(let n=0;n<256;n++)e[n]=ue(D(e[n])*D(1353));return e}function Q(e,t){let n=oe(e[0],t[0]),r;for(let o=1;o<e.length;o++)r=oe(e[o],t[o]),n=V(n,r);return O(n)}function oe(e,t){let n,r;for(let o=0;o<256/4;o++)n=se(e[4*o+0],e[4*o+1],t[4*o+0],t[4*o+1],K[64+o]),r=se(e[4*o+2],e[4*o+3],t[4*o+2],t[4*o+3],-K[64+o]),e[4*o+0]=n[0],e[4*o+1]=n[1],e[4*o+2]=r[0],e[4*o+3]=r[1];return e}function se(e,t,n,r,o){let s=new Array(2);return s[0]=H(t,r),s[0]=H(s[0],o),s[0]+=H(e,n),s[1]=H(e,r),s[1]+=H(t,n),s}function V(e,t){let n=new Array(384);for(let r=0;r<256;r++)n[r]=e[r]+t[r];return n}function Ye(e,t){for(let n=0;n<256;n++)e[n]-=t[n];return e}function nt(e){let t=0;for(let n=0,r=2;r<=128;r<<=1)for(let o=0;o<256;o=t+r){let s=W[n];for(n=n+1,t=o;t<o+r;t++){let i=e[t];e[t]=ie(i+e[t+r]),e[t+r]=i-e[t+r],e[t+r]=H(s,e[t+r])}}for(t=0;t<256;t++)e[t]=H(e[t],W[127]);return e}function ce(e){for(let t=0;t<256;t++)e[t]-=3329,e[t]+=e[t]>>31&3329;return e}var ot=class extends z{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_sampleNoise1(t,n,r){let o=new Array(r);for(let s=0;s<r;s++)o[s]=$e(N(this._eta1*256/4,t,n),this._eta1),n++;return o}};function $e(e,t){let n,r,o,s,i=new Array(384).fill(0);for(let u=0;u<256/4;u++){n=Yt(e.subarray(3*u,e.length)),r=n&2396745,r=r+(n>>1&2396745),r=r+(n>>2&2396745);for(let p=0;p<4;p++)o=k(r>>6*p+0&7),s=k(r>>6*p+t&7),i[4*u+p]=o-s}return i}var st=class extends z{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}};var it=class extends z{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:11}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_compressU(t,n){let r=new Array(8);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/8;i++){for(let u=0;u<8;u++)r[u]=a(((b(n[s][8*i+u])<<11)+b(3329/2))/b(3329)&2047);t[o++]=d(r[0]>>0),t[o++]=d(r[0]>>8|r[1]<<3),t[o++]=d(r[1]>>5|r[2]<<6),t[o++]=d(r[2]>>2),t[o++]=d(r[2]>>10|r[3]<<1),t[o++]=d(r[3]>>7|r[4]<<4),t[o++]=d(r[4]>>4|r[5]<<7),t[o++]=d(r[5]>>1),t[o++]=d(r[5]>>9|r[6]<<2),t[o++]=d(r[6]>>6|r[7]<<5),t[o++]=d(r[7]>>3)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let o=0,s=0;s<256/8;s++){for(let i=0;i<8;i++)r[i]=d(((b(n[8*s+i])<<5)+b(3329/2))/b(3329))&31;t[o++]=d(r[0]>>0|r[1]<<5),t[o++]=d(r[1]>>3|r[2]<<2|r[3]<<7),t[o++]=d(r[3]>>1|r[4]<<4),t[o++]=d(r[4]>>4|r[5]<<1|r[6]<<6),t[o++]=d(r[6]>>2|r[7]<<3)}return t}_decompressU(t){let n=new Array(this._k);for(let o=0;o<this._k;o++)n[o]=new Array(384);let r=new Array(8);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/8;i++){r[0]=a(t[o+0])>>0|a(t[o+1])<<8,r[1]=a(t[o+1])>>3|a(t[o+2])<<5,r[2]=a(t[o+2])>>6|a(t[o+3])<<2|a(t[o+4])<<10,r[3]=a(t[o+4])>>1|a(t[o+5])<<7,r[4]=a(t[o+5])>>4|a(t[o+6])<<4,r[5]=a(t[o+6])>>7|a(t[o+7])<<1|a(t[o+8])<<9,r[6]=a(t[o+8])>>2|a(t[o+9])<<6,r[7]=a(t[o+9])>>5|a(t[o+10])<<3,o=o+11;for(let u=0;u<8;u++)n[s][8*i+u]=b(r[u]&2047)*3329+1024>>11}return n}_decompressV(t){let n=new Array(384),r=new Array(8);for(let o=0,s=0;s<256/8;s++){r[0]=t[o+0]>>0,r[1]=t[o+0]>>5|t[o+1]<<3,r[2]=t[o+1]>>2,r[3]=t[o+1]>>7|t[o+2]<<1,r[4]=t[o+2]>>4|t[o+3]<<4,r[5]=t[o+3]>>1,r[6]=t[o+3]>>6|t[o+4]<<2,r[7]=t[o+4]>>3,o=o+5;for(let i=0;i<8;i++)n[8*s+i]=k(b(r[i]&31)*b(3329)+16>>5)}return n}};export{it as MlKem1024,ot as MlKem512,st as MlKem768,v as MlKemError};
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
