var ce=Object.create;var at=Object.defineProperty;var ae=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var fe=Object.getPrototypeOf,he=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var pe=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of le(t))!he.call(e,s)&&s!==n&&at(e,s,{get:()=>t[s],enumerable:!(r=ae(t,s))||r.enumerable});return e};var de=(e,t,n)=>(n=e!=null?ce(fe(e)):{},pe(t||!e||!e.__esModule?at(n,"default",{value:e,enumerable:!0}):n,e));var Y=I(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.anumber=F;A.number=F;A.abytes=q;A.bytes=q;A.ahash=lt;A.aexists=ft;A.aoutput=ht;function F(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function ye(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function q(e,...t){if(!ye(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function lt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");F(e.outputLen),F(e.blockLen)}function ft(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ht(e,t){q(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var _e={number:F,bytes:q,hash:lt,exists:ft,output:ht};A.default=_e});var Et=I(a=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.add5L=a.add5H=a.add4H=a.add4L=a.add3H=a.add3L=a.rotlBL=a.rotlBH=a.rotlSL=a.rotlSH=a.rotr32L=a.rotr32H=a.rotrBL=a.rotrBH=a.rotrSL=a.rotrSH=a.shrSL=a.shrSH=a.toBig=void 0;a.fromBig=tt;a.split=pt;a.add=Bt;var X=BigInt(2**32-1),$=BigInt(32);function tt(e,t=!1){return t?{h:Number(e&X),l:Number(e>>$&X)}:{h:Number(e>>$&X)|0,l:Number(e&X)|0}}function pt(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:o,l:i}=tt(e[s],t);[n[s],r[s]]=[o,i]}return[n,r]}var dt=(e,t)=>BigInt(e>>>0)<<$|BigInt(t>>>0);a.toBig=dt;var yt=(e,t,n)=>e>>>n;a.shrSH=yt;var _t=(e,t,n)=>e<<32-n|t>>>n;a.shrSL=_t;var bt=(e,t,n)=>e>>>n|t<<32-n;a.rotrSH=bt;var wt=(e,t,n)=>e<<32-n|t>>>n;a.rotrSL=wt;var kt=(e,t,n)=>e<<64-n|t>>>n-32;a.rotrBH=kt;var mt=(e,t,n)=>e>>>n-32|t<<64-n;a.rotrBL=mt;var gt=(e,t)=>t;a.rotr32H=gt;var St=(e,t)=>e;a.rotr32L=St;var xt=(e,t,n)=>e<<n|t>>>32-n;a.rotlSH=xt;var At=(e,t,n)=>t<<n|e>>>32-n;a.rotlSL=At;var Lt=(e,t,n)=>t<<n-32|e>>>64-n;a.rotlBH=Lt;var vt=(e,t,n)=>e<<n-32|t>>>64-n;a.rotlBL=vt;function Bt(e,t,n,r){let s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}var Ut=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);a.add3L=Ut;var zt=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;a.add3H=zt;var Pt=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);a.add4L=Pt;var Ot=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0;a.add4H=Ot;var Tt=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0);a.add5L=Tt;var Ht=(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0;a.add5H=Ht;var be={fromBig:tt,split:pt,toBig:dt,shrSH:yt,shrSL:_t,rotrSH:bt,rotrSL:wt,rotrBH:kt,rotrBL:mt,rotr32H:gt,rotr32L:St,rotlSH:xt,rotlSL:At,rotlBH:Lt,rotlBL:vt,add:Bt,add3L:Ut,add3H:zt,add4L:Pt,add4H:Ot,add5H:Ht,add5L:Tt};a.default=be});var jt=I(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.crypto=void 0;D.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Vt=I(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});f.Hash=f.nextTick=f.byteSwapIfBE=f.byteSwap=f.isLE=f.rotl=f.rotr=f.createView=f.u32=f.u8=void 0;f.isBytes=we;f.byteSwap32=Le;f.bytesToHex=Be;f.hexToBytes=Ue;f.asyncLoop=Pe;f.utf8ToBytes=Ft;f.toBytes=Q;f.concatBytes=Oe;f.checkOpts=Te;f.wrapConstructor=He;f.wrapConstructorWithOpts=Ee;f.wrapXOFConstructorWithOpts=je;f.randomBytes=Ie;var H=jt(),rt=Y();function we(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}var ke=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);f.u8=ke;var me=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));f.u32=me;var ge=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);f.createView=ge;var Se=(e,t)=>e<<32-t|e>>>t;f.rotr=Se;var xe=(e,t)=>e<<t|e>>>32-t>>>0;f.rotl=xe;f.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Ae=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;f.byteSwap=Ae;f.byteSwapIfBE=f.isLE?e=>e:e=>(0,f.byteSwap)(e);function Le(e){for(let t=0;t<e.length;t++)e[t]=(0,f.byteSwap)(e[t])}var ve=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Be(e){(0,rt.abytes)(e);let t="";for(let n=0;n<e.length;n++)t+=ve[e[n]];return t}var L={_0:48,_9:57,A:65,F:70,a:97,f:102};function It(e){if(e>=L._0&&e<=L._9)return e-L._0;if(e>=L.A&&e<=L.F)return e-(L.A-10);if(e>=L.a&&e<=L.f)return e-(L.a-10)}function Ue(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=It(e.charCodeAt(o)),u=It(e.charCodeAt(o+1));if(i===void 0||u===void 0){let p=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+o)}r[s]=i*16+u}return r}var ze=async()=>{};f.nextTick=ze;async function Pe(e,t,n){let r=Date.now();for(let s=0;s<e;s++){n(s);let o=Date.now()-r;o>=0&&o<t||(await(0,f.nextTick)(),r+=o)}}function Ft(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Q(e){return typeof e=="string"&&(e=Ft(e)),(0,rt.abytes)(e),e}function Oe(...e){let t=0;for(let r=0;r<e.length;r++){let s=e[r];(0,rt.abytes)(s),t+=s.length}let n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){let o=e[r];n.set(o,s),s+=o.length}return n}var et=class{clone(){return this._cloneInto()}};f.Hash=et;function Te(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function He(e){let t=r=>e().update(Q(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ee(e){let t=(r,s)=>e(s).update(Q(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function je(e){let t=(r,s)=>e(s).update(Q(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Ie(e=32){if(H.crypto&&typeof H.crypto.getRandomValues=="function")return H.crypto.getRandomValues(new Uint8Array(e));if(H.crypto&&typeof H.crypto.randomBytes=="function")return H.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}});var Dt=I(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.shake256=_.shake128=_.keccak_512=_.keccak_384=_.keccak_256=_.keccak_224=_.sha3_512=_.sha3_384=_.sha3_256=_.sha3_224=_.Keccak=void 0;_.keccakP=qt;var E=Y(),N=Et(),v=Vt(),Kt=[],Ct=[],Rt=[],Fe=BigInt(0),V=BigInt(1),Ve=BigInt(2),Ne=BigInt(7),Me=BigInt(256),Ke=BigInt(113);for(let e=0,t=V,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],Kt.push(2*(5*r+n)),Ct.push((e+1)*(e+2)/2%64);let s=Fe;for(let o=0;o<7;o++)t=(t<<V^(t>>Ne)*Ke)%Me,t&Ve&&(s^=V<<(V<<BigInt(o))-V);Rt.push(s)}var[Ce,Re]=(0,N.split)(Rt,!0),Nt=(e,t,n)=>n>32?(0,N.rotlBH)(e,t,n):(0,N.rotlSH)(e,t,n),Mt=(e,t,n)=>n>32?(0,N.rotlBL)(e,t,n):(0,N.rotlSL)(e,t,n);function qt(e,t=24){let n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let u=(i+8)%10,p=(i+2)%10,S=n[p],l=n[p+1],g=Nt(S,l,1)^n[u],j=Mt(S,l,1)^n[u+1];for(let m=0;m<50;m+=10)e[i+m]^=g,e[i+m+1]^=j}let s=e[2],o=e[3];for(let i=0;i<24;i++){let u=Ct[i],p=Nt(s,o,u),S=Mt(s,o,u),l=Kt[i];s=e[l],o=e[l+1],e[l]=p,e[l+1]=S}for(let i=0;i<50;i+=10){for(let u=0;u<10;u++)n[u]=e[i+u];for(let u=0;u<10;u++)e[i+u]^=~n[(u+2)%10]&n[(u+4)%10]}e[0]^=Ce[r],e[1]^=Re[r]}n.fill(0)}var M=class e extends v.Hash{constructor(t,n,r,s=!1,o=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=o,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,E.anumber)(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,v.u32)(this.state)}keccak(){v.isLE||(0,v.byteSwap32)(this.state32),qt(this.state32,this.rounds),v.isLE||(0,v.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,E.aexists)(this);let{blockLen:n,state:r}=this;t=(0,v.toBytes)(t);let s=t.length;for(let o=0;o<s;){let i=Math.min(n-this.pos,s-o);for(let u=0;u<i;u++)r[this.pos++]^=t[o++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,n&128&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){(0,E.aexists)(this,!1),(0,E.abytes)(t),this.finish();let n=this.state,{blockLen:r}=this;for(let s=0,o=t.length;s<o;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,o-s);t.set(n.subarray(this.posOut,this.posOut+i),s),this.posOut+=i,s+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,E.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,E.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:n,suffix:r,outputLen:s,rounds:o,enableXOF:i}=this;return t||(t=new e(n,r,s,i,o)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=o,t.suffix=r,t.outputLen=s,t.enableXOF=i,t.destroyed=this.destroyed,t}};_.Keccak=M;var z=(e,t,n)=>(0,v.wrapConstructor)(()=>new M(t,e,n));_.sha3_224=z(6,144,224/8);_.sha3_256=z(6,136,256/8);_.sha3_384=z(6,104,384/8);_.sha3_512=z(6,72,512/8);_.keccak_224=z(1,144,224/8);_.keccak_256=z(1,136,256/8);_.keccak_384=z(1,104,384/8);_.keccak_512=z(1,72,512/8);var Xt=(e,t,n)=>(0,v.wrapXOFConstructorWithOpts)((r={})=>new M(t,e,r.dkLen===void 0?n:r.dkLen,!0));_.shake128=Xt(31,168,128/8);_.shake256=Xt(31,136,256/8)});var U=class extends Error{constructor(t){let n;t instanceof Error?n=t.message:typeof t=="string"?n=t:n="",super(n),this.name=this.constructor.name}};var R=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],J=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441];var x=de(Dt(),1);var qe={},Qt=Xe(globalThis,qe);function Xe(e,t){return new Proxy(e,{get(n,r,s){return r in t?t[r]:e[r]},set(n,r,s){return r in t&&delete t[r],e[r]=s,!0},deleteProperty(n,r){let s=!1;return r in t&&(delete t[r],s=!0),r in e&&(delete e[r],s=!0),s},ownKeys(n){let r=Reflect.ownKeys(e),s=Reflect.ownKeys(t),o=new Set(s);return[...r.filter(i=>!o.has(i)),...s]},defineProperty(n,r,s){return r in t&&delete t[r],Reflect.defineProperty(e,r,s),!0},getOwnPropertyDescriptor(n,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(n,r){return r in t||r in e}})}function d(e){return e%256}function k(e){return e>=-32768&&e<=32767?e:e<-32768?(e=e+32769,e=e%65536,32767+e):(e=e-32768,e=e%65536,-32768+e)}function c(e){return e%65536}function W(e){return e>=-2147483648&&e<=2147483647?e:e<-2147483648?(e=e+2147483649,e=e%4294967296,2147483647+e):(e=e-2147483648,e=e%4294967296,-2147483648+e)}function w(e){return e%4294967296}function Wt(e,t){if(e.length!=t.length)return 0;let n=new Uint8Array([0]);for(let s=0;s<e.length;s++)n[0]|=e[s]^t[s];let r=new Uint8Array([0]);return r[0]=~(n[0]^r[0]),r[0]&=r[0]>>4,r[0]&=r[0]>>2,r[0]&=r[0]>>1,r[0]}function Zt(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}async function Gt(){if(typeof Qt<"u"&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:e}=await import("crypto");return e}catch{throw new Error("failed to load Crypto")}}function K(e,t,n){return x.shake256.create({dkLen:e}).update(t).update(new Uint8Array([n])).digest()}function Jt(e){let t=w(e[0]);return t|=w(e[1])<<8,t|=w(e[2])<<16,t}function Yt(e){let t=w(e[0]);return t|=w(e[1])<<8,t|=w(e[2])<<16,t|=w(e[3])<<24,w(t)}var O=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_skSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pkSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedUSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedVSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}async generateKeyPair(){await this._setup();try{let t=new Uint8Array(64);return this._api.getRandomValues(t),this._deriveKeyPair(t)}catch(t){throw new U(t)}}async deriveKeyPair(t){await this._setup();try{if(t.byteLength!==64)throw new Error("seed must be 64 bytes in length");return this._deriveKeyPair(t)}catch(n){throw new U(n)}}async encap(t,n){await this._setup();try{if(t.length!==384*this._k+32)throw new Error("invalid encapsulation key");let r=this._getSeed(n),[s,o]=nt(r,$t(t));return[this._encap(t,r,o),s]}catch(r){throw new U(r)}}async decap(t,n){await this._setup();try{if(t.byteLength!==this._compressedUSize+this._compressedVSize)throw new Error("Invalid ct size");if(n.length!==768*this._k+96)throw new Error("Invalid decapsulation key");let r=n.subarray(0,this._skSize),s=n.subarray(this._skSize,this._skSize+this._pkSize),o=n.subarray(this._skSize+this._pkSize,this._skSize+this._pkSize+32),i=n.subarray(this._skSize+this._pkSize+32,this._skSize+this._pkSize+64),u=this._decap(t,r),[p,S]=nt(u,o),l=We(i,t),g=this._encap(s,u,S);return Wt(t,g)===1?p:l}catch(r){throw new U(r)}}async _setup(){this._api===void 0&&(this._api=await Gt())}_getSeed(t){if(t==null){let n=new Uint8Array(32);return this._api.getRandomValues(n),n}if(t.byteLength!==32)throw new Error("seed must be 32 bytes in length");return t}_deriveKeyPair(t){let n=t.subarray(0,32),r=t.subarray(32,64),[s,o]=this._deriveCpaKeyPair(n),i=$t(s),u=new Uint8Array(this._skSize+this._pkSize+64);return u.set(o,0),u.set(s,this._skSize),u.set(i,this._skSize+this._pkSize),u.set(r,this._skSize+this._pkSize+32),[s,u]}_deriveCpaKeyPair(t){let[n,r]=nt(t,new Uint8Array([this._k])),s=this._sampleMatrix(n,!1),o=this._sampleNoise1(r,0,this._k),i=this._sampleNoise1(r,this._k,this._k);for(let l=0;l<this._k;l++)o[l]=Z(o[l]),o[l]=T(o[l]),i[l]=Z(i[l]);let u=new Array(this._k);for(let l=0;l<this._k;l++)u[l]=Ye(G(s[l],o)),u[l]=C(u[l],i[l]),u[l]=T(u[l]);let p=new Uint8Array(this._pkSize);for(let l=0;l<this._k;l++)p.set(st(u[l]),l*384);p.set(n,this._skSize);let S=new Uint8Array(this._skSize);for(let l=0;l<this._k;l++)S.set(st(o[l]),l*384);return[p,S]}_encap(t,n,r){let s=new Array(this._k),o=new Uint8Array(384*this._k);for(let y=0;y<this._k;y++)s[y]=te(t.subarray(y*384,(y+1)*384)),o.set(st(s[y]),y*384);if(!Zt(t.subarray(0,o.length),o))throw new Error("invalid encapsulation key");let i=t.subarray(this._skSize),u=this._sampleMatrix(i,!0),p=this._sampleNoise1(r,0,this._k),S=this._sampleNoise2(r,this._k,this._k),l=this._sampleNoise2(r,this._k*2,1)[0];for(let y=0;y<this._k;y++)p[y]=Z(p[y]),p[y]=T(p[y]);let g=new Array(this._k);for(let y=0;y<this._k;y++)g[y]=G(u[y],p),g[y]=ot(g[y]),g[y]=C(g[y],S[y]),g[y]=T(g[y]);let j=Je(n),m=G(s,p);m=ot(m),m=C(m,l),m=C(m,j),m=T(m);let B=new Uint8Array(this._compressedUSize+this._compressedVSize);return this._compressU(B.subarray(0,this._compressedUSize),g),this._compressV(B.subarray(this._compressedUSize),m),B}_decap(t,n){let r=this._decompressU(t.subarray(0,this._compressedUSize)),s=this._decompressV(t.subarray(this._compressedUSize)),o=this._polyvecFromBytes(n);for(let u=0;u<this._k;u++)r[u]=Z(r[u]);let i=G(o,r);return i=ot(i),i=$e(s,i),i=T(i),Ge(i)}_sampleMatrix(t,n){let r=new Array(this._k),s=new Uint8Array(2);for(let o=0,i=0;i<this._k;i++){r[i]=new Array(this._k);for(let u=0;u<this._k;u++){n?(s[0]=i,s[1]=u):(s[0]=u,s[1]=i);let p=Ze(t,s),S=ee(p.subarray(0,504),504,256);for(r[i][u]=S[0],o=S[1];o<256;){let l=p.subarray(504,672),g=ee(l,168,256-o),j=g[0],m=g[1];for(let B=o;B<256;B++)r[i][u][B]=j[B-o];o=o+m}}}return r}_sampleNoise1(t,n,r){let s=new Array(r);for(let o=0;o<r;o++)s[o]=re(K(this._eta1*256/4,t,n),this._eta1),n++;return s}_sampleNoise2(t,n,r){let s=new Array(r);for(let o=0;o<r;o++)s[o]=re(K(this._eta2*256/4,t,n),this._eta2),n++;return s}_polyvecFromBytes(t){let n=new Array(this._k);for(let r=0;r<this._k;r++)n[r]=te(t.subarray(r*384,(r+1)*384));return n}_compressU(t,n){let r=new Array(4);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/4;i++){for(let u=0;u<4;u++)r[u]=((n[o][4*i+u]<<10)+3329/2)/3329&1023;t[s++]=d(r[0]>>0),t[s++]=d(r[0]>>8|r[1]<<2),t[s++]=d(r[1]>>6|r[2]<<4),t[s++]=d(r[2]>>4|r[3]<<6),t[s++]=d(r[3]>>2)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let s=0,o=0;o<256/8;o++){for(let i=0;i<8;i++)r[i]=d(((n[8*o+i]<<4)+3329/2)/3329)&15;t[s++]=r[0]|r[1]<<4,t[s++]=r[2]|r[3]<<4,t[s++]=r[4]|r[5]<<4,t[s++]=r[6]|r[7]<<4}return t}_decompressU(t){let n=new Array(this._k);for(let s=0;s<this._k;s++)n[s]=new Array(384);let r=new Array(4);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/4;i++){r[0]=c(t[s+0])>>0|c(t[s+1])<<8,r[1]=c(t[s+1])>>2|c(t[s+2])<<6,r[2]=c(t[s+2])>>4|c(t[s+3])<<4,r[3]=c(t[s+3])>>6|c(t[s+4])<<2,s=s+5;for(let u=0;u<4;u++)n[o][4*i+u]=k(w(r[u]&1023)*w(3329)+512>>10)}return n}_decompressV(t){let n=new Array(384);for(let r=0,s=0;s<256/2;s++,r++)n[2*s+0]=k(c(t[r]&15)*c(3329)+8>>4),n[2*s+1]=k(c(t[r]>>4)*c(3329)+8>>4);return n}};function nt(e,t){let n=x.sha3_512.create().update(e);t!==void 0&&n.update(t);let r=n.digest();return[r.subarray(0,32),r.subarray(32,64)]}function $t(e){return x.sha3_256.create().update(e).digest()}function We(e,t){let n=x.shake256.create({dkLen:32}).update(e);return t!==void 0&&n.update(t),n.digest()}function Ze(e,t){return x.shake128.create({dkLen:672}).update(e).update(t).digest()}function st(e){let t=0,n=0,r=new Uint8Array(384),s=ue(e);for(let o=0;o<256/2;o++)t=c(s[2*o]),n=c(s[2*o+1]),r[3*o+0]=d(t>>0),r[3*o+1]=d(t>>8)|d(n<<4),r[3*o+2]=d(n>>4);return r}function te(e){let t=new Array(384).fill(0);for(let n=0;n<256/2;n++)t[2*n]=k((c(e[3*n+0])>>0|c(e[3*n+1])<<8)&4095),t[2*n+1]=k((c(e[3*n+1])>>4|c(e[3*n+2])<<4)&4095);return t}function Ge(e){let t=new Uint8Array(32),n,r=ue(e);for(let s=0;s<256/8;s++){t[s]=0;for(let o=0;o<8;o++)n=((c(r[8*s+o])<<1)+c(3329/2))/c(3329)&1,t[s]|=d(n<<o)}return t}function Je(e){let t=new Array(384).fill(0),n;for(let r=0;r<256/8;r++)for(let s=0;s<8;s++)n=-1*k(e[r]>>s&1),t[8*r+s]=n&k(3330/2);return t}function ee(e,t,n){let r=new Array(384).fill(0),s=0,o,i;for(let u=0;s<n&&u+3<=t;)o=(c(e[u]>>0)|c(e[u+1])<<8)&4095,i=(c(e[u+1]>>4)|c(e[u+2])<<4)&4095,u=u+3,o<3329&&(r[s]=o,s=s+1),s<n&&i<3329&&(r[s]=i,s=s+1);return[r,s]}function re(e,t){let n,r,s,o,i=new Array(384).fill(0);for(let u=0;u<256/8;u++){n=Yt(e.subarray(4*u,e.length)),r=n&1431655765,r=r+(n>>1&1431655765);for(let p=0;p<8;p++)s=k(r>>4*p+0&3),o=k(r>>4*p+t&3),i[8*u+p]=s-o}return i}function Z(e){for(let t=0,n=1,r=128;r>=2;r>>=1)for(let s=0;s<256;s=t+r){let o=R[n];for(n=n+1,t=s;t<s+r;t++){let i=P(o,e[t+r]);e[t+r]=e[t]-i,e[t]=e[t]+i}}return e}function P(e,t){return ie(e*t)}function T(e){for(let t=0;t<256;t++)e[t]=oe(e[t]);return e}function oe(e){let n=(16777216+3329/2)/3329*e>>24;return n=n*3329,e-n}function ie(e){let n=k(W(e)*62209)*3329;return n=e-n,n>>=16,k(n)}function Ye(e){for(let n=0;n<256;n++)e[n]=ie(W(e[n])*W(1353));return e}function G(e,t){let n=ne(e[0],t[0]),r;for(let s=1;s<e.length;s++)r=ne(e[s],t[s]),n=C(n,r);return T(n)}function ne(e,t){let n,r;for(let s=0;s<256/4;s++)n=se(e[4*s+0],e[4*s+1],t[4*s+0],t[4*s+1],R[64+s]),r=se(e[4*s+2],e[4*s+3],t[4*s+2],t[4*s+3],-R[64+s]),e[4*s+0]=n[0],e[4*s+1]=n[1],e[4*s+2]=r[0],e[4*s+3]=r[1];return e}function se(e,t,n,r,s){let o=new Array(2);return o[0]=P(t,r),o[0]=P(o[0],s),o[0]+=P(e,n),o[1]=P(e,r),o[1]+=P(t,n),o}function C(e,t){let n=new Array(384);for(let r=0;r<256;r++)n[r]=e[r]+t[r];return n}function $e(e,t){for(let n=0;n<256;n++)e[n]-=t[n];return e}function ot(e){let t=0;for(let n=0,r=2;r<=128;r<<=1)for(let s=0;s<256;s=t+r){let o=J[n];for(n=n+1,t=s;t<s+r;t++){let i=e[t];e[t]=oe(i+e[t+r]),e[t+r]=i-e[t+r],e[t+r]=P(o,e[t+r])}}for(t=0;t<256;t++)e[t]=P(e[t],J[127]);return e}function ue(e){for(let t=0;t<256;t++)e[t]-=3329,e[t]+=e[t]>>31&3329;return e}var it=class extends O{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_sampleNoise1(t,n,r){let s=new Array(r);for(let o=0;o<r;o++)s[o]=tr(K(this._eta1*256/4,t,n),this._eta1),n++;return s}};function tr(e,t){let n,r,s,o,i=new Array(384).fill(0);for(let u=0;u<256/4;u++){n=Jt(e.subarray(3*u,e.length)),r=n&2396745,r=r+(n>>1&2396745),r=r+(n>>2&2396745);for(let p=0;p<4;p++)s=k(r>>6*p+0&7),o=k(r>>6*p+t&7),i[4*u+p]=s-o}return i}var ut=class extends O{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}};var ct=class extends O{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:11}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_compressU(t,n){let r=new Array(8);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/8;i++){for(let u=0;u<8;u++)r[u]=c(((w(n[o][8*i+u])<<11)+w(3329/2))/w(3329)&2047);t[s++]=d(r[0]>>0),t[s++]=d(r[0]>>8|r[1]<<3),t[s++]=d(r[1]>>5|r[2]<<6),t[s++]=d(r[2]>>2),t[s++]=d(r[2]>>10|r[3]<<1),t[s++]=d(r[3]>>7|r[4]<<4),t[s++]=d(r[4]>>4|r[5]<<7),t[s++]=d(r[5]>>1),t[s++]=d(r[5]>>9|r[6]<<2),t[s++]=d(r[6]>>6|r[7]<<5),t[s++]=d(r[7]>>3)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let s=0,o=0;o<256/8;o++){for(let i=0;i<8;i++)r[i]=d(((w(n[8*o+i])<<5)+w(3329/2))/w(3329))&31;t[s++]=d(r[0]>>0|r[1]<<5),t[s++]=d(r[1]>>3|r[2]<<2|r[3]<<7),t[s++]=d(r[3]>>1|r[4]<<4),t[s++]=d(r[4]>>4|r[5]<<1|r[6]<<6),t[s++]=d(r[6]>>2|r[7]<<3)}return t}_decompressU(t){let n=new Array(this._k);for(let s=0;s<this._k;s++)n[s]=new Array(384);let r=new Array(8);for(let s=0,o=0;o<this._k;o++)for(let i=0;i<256/8;i++){r[0]=c(t[s+0])>>0|c(t[s+1])<<8,r[1]=c(t[s+1])>>3|c(t[s+2])<<5,r[2]=c(t[s+2])>>6|c(t[s+3])<<2|c(t[s+4])<<10,r[3]=c(t[s+4])>>1|c(t[s+5])<<7,r[4]=c(t[s+5])>>4|c(t[s+6])<<4,r[5]=c(t[s+6])>>7|c(t[s+7])<<1|c(t[s+8])<<9,r[6]=c(t[s+8])>>2|c(t[s+9])<<6,r[7]=c(t[s+9])>>5|c(t[s+10])<<3,s=s+11;for(let u=0;u<8;u++)n[o][8*i+u]=w(r[u]&2047)*3329+1024>>11}return n}_decompressV(t){let n=new Array(384),r=new Array(8);for(let s=0,o=0;o<256/8;o++){r[0]=t[s+0]>>0,r[1]=t[s+0]>>5|t[s+1]<<3,r[2]=t[s+1]>>2,r[3]=t[s+1]>>7|t[s+2]<<1,r[4]=t[s+2]>>4|t[s+3]<<4,r[5]=t[s+3]>>1,r[6]=t[s+3]>>6|t[s+4]<<2,r[7]=t[s+4]>>3,s=s+5;for(let i=0;i<8;i++)n[8*o+i]=k(w(r[i]&31)*w(3329)+16>>5)}return n}};export{ct as MlKem1024,it as MlKem512,ut as MlKem768,U as MlKemError};
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
