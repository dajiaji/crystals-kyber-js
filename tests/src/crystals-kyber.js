var le=Object.create;var at=Object.defineProperty;var fe=Object.getOwnPropertyDescriptor;var he=Object.getOwnPropertyNames;var pe=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ye=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of he(t))!de.call(e,o)&&o!==n&&at(e,o,{get:()=>t[o],enumerable:!(r=fe(t,o))||r.enumerable});return e};var _e=(e,t,n)=>(n=e!=null?le(pe(e)):{},ye(t||!e||!e.__esModule?at(n,"default",{value:e,enumerable:!0}):n,e));var J=I(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.isBytes=ft;A.number=R;A.bool=lt;A.bytes=G;A.hash=ht;A.exists=pt;A.output=dt;function R(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function lt(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function ft(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function G(e,...t){if(!ft(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function ht(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");R(e.outputLen),R(e.blockLen)}function pt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function dt(e,t){G(e);let n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}var be={number:R,bool:lt,bytes:G,hash:ht,exists:pt,output:dt};A.default=be});var It=I(a=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.add5L=a.add5H=a.add4H=a.add4L=a.add3H=a.add3L=a.rotlBL=a.rotlBH=a.rotlSL=a.rotlSH=a.rotr32L=a.rotr32H=a.rotrBL=a.rotrBH=a.rotrSL=a.rotrSH=a.shrSL=a.shrSH=a.toBig=void 0;a.fromBig=tt;a.split=yt;a.add=zt;var q=BigInt(2**32-1),Y=BigInt(32);function tt(e,t=!1){return t?{h:Number(e&q),l:Number(e>>Y&q)}:{h:Number(e>>Y&q)|0,l:Number(e&q)|0}}function yt(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:s,l:i}=tt(e[o],t);[n[o],r[o]]=[s,i]}return[n,r]}var _t=(e,t)=>BigInt(e>>>0)<<Y|BigInt(t>>>0);a.toBig=_t;var bt=(e,t,n)=>e>>>n;a.shrSH=bt;var wt=(e,t,n)=>e<<32-n|t>>>n;a.shrSL=wt;var kt=(e,t,n)=>e>>>n|t<<32-n;a.rotrSH=kt;var mt=(e,t,n)=>e<<32-n|t>>>n;a.rotrSL=mt;var gt=(e,t,n)=>e<<64-n|t>>>n-32;a.rotrBH=gt;var St=(e,t,n)=>e>>>n-32|t<<64-n;a.rotrBL=St;var xt=(e,t)=>t;a.rotr32H=xt;var At=(e,t)=>e;a.rotr32L=At;var Lt=(e,t,n)=>e<<n|t>>>32-n;a.rotlSH=Lt;var vt=(e,t,n)=>t<<n|e>>>32-n;a.rotlSL=vt;var Bt=(e,t,n)=>t<<n-32|e>>>64-n;a.rotlBH=Bt;var Ut=(e,t,n)=>e<<n-32|t>>>64-n;a.rotlBL=Ut;function zt(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var Pt=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0);a.add3L=Pt;var Ot=(e,t,n,r)=>t+n+r+(e/2**32|0)|0;a.add3H=Ot;var Tt=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0);a.add4L=Tt;var Ht=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0;a.add4H=Ht;var Et=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0);a.add5L=Et;var jt=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;a.add5H=jt;var we={fromBig:tt,split:yt,toBig:_t,shrSH:bt,shrSL:wt,rotrSH:kt,rotrSL:mt,rotrBH:gt,rotrBL:St,rotr32H:xt,rotr32L:At,rotlSH:Lt,rotlSL:vt,rotlBH:Bt,rotlBL:Ut,add:zt,add3L:Pt,add3H:Ot,add4L:Tt,add4H:Ht,add5H:jt,add5L:Et};a.default=we});var Ft=I(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.crypto=void 0;X.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var Mt=I(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});f.Hash=f.nextTick=f.byteSwapIfBE=f.byteSwap=f.isLE=f.rotl=f.rotr=f.createView=f.u32=f.u8=void 0;f.isBytes=ke;f.byteSwap32=ve;f.bytesToHex=Ue;f.hexToBytes=ze;f.asyncLoop=Oe;f.utf8ToBytes=Vt;f.toBytes=D;f.concatBytes=Te;f.checkOpts=Ee;f.wrapConstructor=je;f.wrapConstructorWithOpts=Ie;f.wrapXOFConstructorWithOpts=Fe;f.randomBytes=Ne;var H=Ft(),rt=J();function ke(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var me=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);f.u8=me;var ge=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));f.u32=ge;var Se=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);f.createView=Se;var xe=(e,t)=>e<<32-t|e>>>t;f.rotr=xe;var Ae=(e,t)=>e<<t|e>>>32-t>>>0;f.rotl=Ae;f.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var Le=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;f.byteSwap=Le;f.byteSwapIfBE=f.isLE?e=>e:e=>(0,f.byteSwap)(e);function ve(e){for(let t=0;t<e.length;t++)e[t]=(0,f.byteSwap)(e[t])}var Be=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ue(e){(0,rt.bytes)(e);let t="";for(let n=0;n<e.length;n++)t+=Be[e[n]];return t}var L={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Nt(e){if(e>=L._0&&e<=L._9)return e-L._0;if(e>=L._A&&e<=L._F)return e-(L._A-10);if(e>=L._a&&e<=L._f)return e-(L._a-10)}function ze(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let i=Nt(e.charCodeAt(s)),u=Nt(e.charCodeAt(s+1));if(i===void 0||u===void 0){let p=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+p+'" at index '+s)}r[o]=i*16+u}return r}var Pe=async()=>{};f.nextTick=Pe;async function Oe(e,t,n){let r=Date.now();for(let o=0;o<e;o++){n(o);let s=Date.now()-r;s>=0&&s<t||(await(0,f.nextTick)(),r+=s)}}function Vt(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function D(e){return typeof e=="string"&&(e=Vt(e)),(0,rt.bytes)(e),e}function Te(...e){let t=0;for(let r=0;r<e.length;r++){let o=e[r];(0,rt.bytes)(o),t+=o.length}let n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){let s=e[r];n.set(s,o),o+=s.length}return n}var et=class{clone(){return this._cloneInto()}};f.Hash=et;var He={}.toString;function Ee(e,t){if(t!==void 0&&He.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function je(e){let t=r=>e().update(D(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Ie(e){let t=(r,o)=>e(o).update(D(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Fe(e){let t=(r,o)=>e(o).update(D(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Ne(e=32){if(H.crypto&&typeof H.crypto.getRandomValues=="function")return H.crypto.getRandomValues(new Uint8Array(e));if(H.crypto&&typeof H.crypto.randomBytes=="function")return H.crypto.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}});var $t=I(_=>{"use strict";Object.defineProperty(_,"__esModule",{value:!0});_.shake256=_.shake128=_.keccak_512=_.keccak_384=_.keccak_256=_.keccak_224=_.sha3_512=_.sha3_384=_.sha3_256=_.sha3_224=_.Keccak=void 0;_.keccakP=Dt;var E=J(),N=It(),v=Mt(),Rt=[],qt=[],Xt=[],Ve=BigInt(0),F=BigInt(1),Me=BigInt(2),Ke=BigInt(7),Ce=BigInt(256),Re=BigInt(113);for(let e=0,t=F,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],Rt.push(2*(5*r+n)),qt.push((e+1)*(e+2)/2%64);let o=Ve;for(let s=0;s<7;s++)t=(t<<F^(t>>Ke)*Re)%Ce,t&Me&&(o^=F<<(F<<BigInt(s))-F);Xt.push(o)}var[qe,Xe]=(0,N.split)(Xt,!0),Kt=(e,t,n)=>n>32?(0,N.rotlBH)(e,t,n):(0,N.rotlSH)(e,t,n),Ct=(e,t,n)=>n>32?(0,N.rotlBL)(e,t,n):(0,N.rotlSL)(e,t,n);function Dt(e,t=24){let n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){let u=(i+8)%10,p=(i+2)%10,S=n[p],l=n[p+1],g=Kt(S,l,1)^n[u],j=Ct(S,l,1)^n[u+1];for(let m=0;m<50;m+=10)e[i+m]^=g,e[i+m+1]^=j}let o=e[2],s=e[3];for(let i=0;i<24;i++){let u=qt[i],p=Kt(o,s,u),S=Ct(o,s,u),l=Rt[i];o=e[l],s=e[l+1],e[l]=p,e[l+1]=S}for(let i=0;i<50;i+=10){for(let u=0;u<10;u++)n[u]=e[i+u];for(let u=0;u<10;u++)e[i+u]^=~n[(u+2)%10]&n[(u+4)%10]}e[0]^=qe[r],e[1]^=Xe[r]}n.fill(0)}var V=class e extends v.Hash{constructor(t,n,r,o=!1,s=24){if(super(),this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=o,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,E.number)(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,v.u32)(this.state)}keccak(){v.isLE||(0,v.byteSwap32)(this.state32),Dt(this.state32,this.rounds),v.isLE||(0,v.byteSwap32)(this.state32),this.posOut=0,this.pos=0}update(t){(0,E.exists)(this);let{blockLen:n,state:r}=this;t=(0,v.toBytes)(t);let o=t.length;for(let s=0;s<o;){let i=Math.min(n-this.pos,o-s);for(let u=0;u<i;u++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:r,blockLen:o}=this;t[r]^=n,n&128&&r===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){(0,E.exists)(this,!1),(0,E.bytes)(t),this.finish();let n=this.state,{blockLen:r}=this;for(let o=0,s=t.length;o<s;){this.posOut>=r&&this.keccak();let i=Math.min(r-this.posOut,s-o);t.set(n.subarray(this.posOut,this.posOut+i),o),this.posOut+=i,o+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,E.number)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,E.output)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:n,suffix:r,outputLen:o,rounds:s,enableXOF:i}=this;return t||(t=new e(n,r,o,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=o,t.enableXOF=i,t.destroyed=this.destroyed,t}};_.Keccak=V;var z=(e,t,n)=>(0,v.wrapConstructor)(()=>new V(t,e,n));_.sha3_224=z(6,144,224/8);_.sha3_256=z(6,136,256/8);_.sha3_384=z(6,104,384/8);_.sha3_512=z(6,72,512/8);_.keccak_224=z(1,144,224/8);_.keccak_256=z(1,136,256/8);_.keccak_384=z(1,104,384/8);_.keccak_512=z(1,72,512/8);var Qt=(e,t,n)=>(0,v.wrapXOFConstructorWithOpts)((r={})=>new V(t,e,r.dkLen===void 0?n:r.dkLen,!0));_.shake128=Qt(31,168,128/8);_.shake256=Qt(31,136,256/8)});var U=class extends Error{constructor(t){let n;t instanceof Error?n=t.message:typeof t=="string"?n=t:n="",super(n),this.name=this.constructor.name}};var C=[2285,2571,2970,1812,1493,1422,287,202,3158,622,1577,182,962,2127,1855,1468,573,2004,264,383,2500,1458,1727,3199,2648,1017,732,608,1787,411,3124,1758,1223,652,2777,1015,2036,1491,3047,1785,516,3321,3009,2663,1711,2167,126,1469,2476,3239,3058,830,107,1908,3082,2378,2931,961,1821,2604,448,2264,677,2054,2226,430,555,843,2078,871,1550,105,422,587,177,3094,3038,2869,1574,1653,3083,778,1159,3182,2552,1483,2727,1119,1739,644,2457,349,418,329,3173,3254,817,1097,603,610,1322,2044,1864,384,2114,3193,1218,1994,2455,220,2142,1670,2144,1799,2051,794,1819,2475,2459,478,3221,3021,996,991,958,1869,1522,1628],Z=[1701,1807,1460,2371,2338,2333,308,108,2851,870,854,1510,2535,1278,1530,1185,1659,1187,3109,874,1335,2111,136,1215,2945,1465,1285,2007,2719,2726,2232,2512,75,156,3e3,2911,2980,872,2685,1590,2210,602,1846,777,147,2170,2551,246,1676,1755,460,291,235,3152,2742,2907,3224,1779,2458,1251,2486,2774,2899,1103,1275,2652,1065,2881,725,1508,2368,398,951,247,1421,3222,2499,271,90,853,1860,3203,1162,1618,666,320,8,2813,1544,282,1838,1293,2314,552,2677,2106,1571,205,2918,1542,2721,2597,2312,681,130,1602,1871,829,2946,3065,1325,2756,1861,1474,1202,2367,3147,1752,2707,171,3127,3042,1907,1836,1517,359,758,1441];var x=_e($t(),1);var De={},Wt=Qe(globalThis,De);function Qe(e,t){return new Proxy(e,{get(n,r,o){return r in t?t[r]:e[r]},set(n,r,o){return r in t&&delete t[r],e[r]=o,!0},deleteProperty(n,r){let o=!1;return r in t&&(delete t[r],o=!0),r in e&&(delete e[r],o=!0),o},ownKeys(n){let r=Reflect.ownKeys(e),o=Reflect.ownKeys(t),s=new Set(o);return[...r.filter(i=>!s.has(i)),...o]},defineProperty(n,r,o){return r in t&&delete t[r],Reflect.defineProperty(e,r,o),!0},getOwnPropertyDescriptor(n,r){return r in t?Reflect.getOwnPropertyDescriptor(t,r):Reflect.getOwnPropertyDescriptor(e,r)},has(n,r){return r in t||r in e}})}function d(e){return e%256}function k(e){return e>=-32768&&e<=32767?e:e<-32768?(e=e+32769,e=e%65536,32767+e):(e=e-32768,e=e%65536,-32768+e)}function c(e){return e%65536}function Q(e){return e>=-2147483648&&e<=2147483647?e:e<-2147483648?(e=e+2147483649,e=e%4294967296,2147483647+e):(e=e-2147483648,e=e%4294967296,-2147483648+e)}function w(e){return e%4294967296}function Zt(e,t){if(e.length!=t.length)return 0;let n=new Uint8Array([0]);for(let o=0;o<e.length;o++)n[0]|=e[o]^t[o];let r=new Uint8Array([0]);return r[0]=~(n[0]^r[0]),r[0]&=r[0]>>4,r[0]&=r[0]>>2,r[0]&=r[0]>>1,r[0]}function Gt(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}async function Jt(){if(typeof Wt<"u"&&globalThis.crypto!==void 0)return globalThis.crypto;try{let{webcrypto:e}=await import("crypto");return e}catch{throw new Error("failed to load Crypto")}}function M(e,t,n){return x.shake256.create({dkLen:e}).update(t).update(new Uint8Array([n])).digest()}function Yt(e){let t=w(e[0]);return t|=w(e[1])<<8,t|=w(e[2])<<16,t}function te(e){let t=w(e[0]);return t|=w(e[1])<<8,t|=w(e[2])<<16,t|=w(e[3])<<24,w(t)}var O=class{constructor(){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_skSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pkSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedUSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_compressedVSize",{enumerable:!0,configurable:!0,writable:!0,value:0})}async generateKeyPair(){await this._setup();try{let t=new Uint8Array(64);return this._api.getRandomValues(t),this._deriveKeyPair(t)}catch(t){throw new U(t)}}async deriveKeyPair(t){await this._setup();try{if(t.byteLength!==64)throw new Error("seed must be 64 bytes in length");return this._deriveKeyPair(t)}catch(n){throw new U(n)}}async encap(t,n){await this._setup();try{if(t.length!==384*this._k+32)throw new Error("invalid encapsulation key");let r=this._getSeed(n),[o,s]=nt(r,ee(t));return[this._encap(t,r,s),o]}catch(r){throw new U(r)}}async decap(t,n){await this._setup();try{if(t.byteLength!==this._compressedUSize+this._compressedVSize)throw new Error("Invalid ct size");if(n.length!==768*this._k+96)throw new Error("Invalid decapsulation key");let r=n.subarray(0,this._skSize),o=n.subarray(this._skSize,this._skSize+this._pkSize),s=n.subarray(this._skSize+this._pkSize,this._skSize+this._pkSize+32),i=n.subarray(this._skSize+this._pkSize+32,this._skSize+this._pkSize+64),u=this._decap(t,r),[p,S]=nt(u,s),l=Ze(i,t),g=this._encap(o,u,S);return Zt(t,g)===1?p:l}catch(r){throw new U(r)}}async _setup(){this._api===void 0&&(this._api=await Jt())}_getSeed(t){if(t==null){let n=new Uint8Array(32);return this._api.getRandomValues(n),n}if(t.byteLength!==32)throw new Error("seed must be 32 bytes in length");return t}_deriveKeyPair(t){let n=t.subarray(0,32),r=t.subarray(32,64),[o,s]=this._deriveCpaKeyPair(n),i=ee(o),u=new Uint8Array(this._skSize+this._pkSize+64);return u.set(s,0),u.set(o,this._skSize),u.set(i,this._skSize+this._pkSize),u.set(r,this._skSize+this._pkSize+32),[o,u]}_deriveCpaKeyPair(t){let[n,r]=nt(t,new Uint8Array([this._k])),o=this._sampleMatrix(n,!1),s=this._sampleNoise1(r,0,this._k),i=this._sampleNoise1(r,this._k,this._k);for(let l=0;l<this._k;l++)s[l]=$(s[l]),s[l]=T(s[l]),i[l]=$(i[l]);let u=new Array(this._k);for(let l=0;l<this._k;l++)u[l]=tr(W(o[l],s)),u[l]=K(u[l],i[l]),u[l]=T(u[l]);let p=new Uint8Array(this._pkSize);for(let l=0;l<this._k;l++)p.set(ot(u[l]),l*384);p.set(n,this._skSize);let S=new Uint8Array(this._skSize);for(let l=0;l<this._k;l++)S.set(ot(s[l]),l*384);return[p,S]}_encap(t,n,r){let o=new Array(this._k),s=new Uint8Array(384*this._k);for(let y=0;y<this._k;y++)o[y]=re(t.subarray(y*384,(y+1)*384)),s.set(ot(o[y]),y*384);if(!Gt(t.subarray(0,s.length),s))throw new Error("invalid encapsulation key");let i=t.subarray(this._skSize),u=this._sampleMatrix(i,!0),p=this._sampleNoise1(r,0,this._k),S=this._sampleNoise2(r,this._k,this._k),l=this._sampleNoise2(r,this._k*2,1)[0];for(let y=0;y<this._k;y++)p[y]=$(p[y]),p[y]=T(p[y]);let g=new Array(this._k);for(let y=0;y<this._k;y++)g[y]=W(u[y],p),g[y]=st(g[y]),g[y]=K(g[y],S[y]),g[y]=T(g[y]);let j=Ye(n),m=W(o,p);m=st(m),m=K(m,l),m=K(m,j),m=T(m);let B=new Uint8Array(this._compressedUSize+this._compressedVSize);return this._compressU(B.subarray(0,this._compressedUSize),g),this._compressV(B.subarray(this._compressedUSize),m),B}_decap(t,n){let r=this._decompressU(t.subarray(0,this._compressedUSize)),o=this._decompressV(t.subarray(this._compressedUSize)),s=this._polyvecFromBytes(n);for(let u=0;u<this._k;u++)r[u]=$(r[u]);let i=W(s,r);return i=st(i),i=er(o,i),i=T(i),Je(i)}_sampleMatrix(t,n){let r=new Array(this._k),o=new Uint8Array(2);for(let s=0,i=0;i<this._k;i++){r[i]=new Array(this._k);for(let u=0;u<this._k;u++){n?(o[0]=i,o[1]=u):(o[0]=u,o[1]=i);let p=Ge(t,o),S=ne(p.subarray(0,504),504,256);for(r[i][u]=S[0],s=S[1];s<256;){let l=p.subarray(504,672),g=ne(l,168,256-s),j=g[0],m=g[1];for(let B=s;B<256;B++)r[i][u][B]=j[B-s];s=s+m}}}return r}_sampleNoise1(t,n,r){let o=new Array(r);for(let s=0;s<r;s++)o[s]=oe(M(this._eta1*256/4,t,n),this._eta1),n++;return o}_sampleNoise2(t,n,r){let o=new Array(r);for(let s=0;s<r;s++)o[s]=oe(M(this._eta2*256/4,t,n),this._eta2),n++;return o}_polyvecFromBytes(t){let n=new Array(this._k);for(let r=0;r<this._k;r++)n[r]=re(t.subarray(r*384,(r+1)*384));return n}_compressU(t,n){let r=new Array(4);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/4;i++){for(let u=0;u<4;u++)r[u]=((n[s][4*i+u]<<10)+3329/2)/3329&1023;t[o++]=d(r[0]>>0),t[o++]=d(r[0]>>8|r[1]<<2),t[o++]=d(r[1]>>6|r[2]<<4),t[o++]=d(r[2]>>4|r[3]<<6),t[o++]=d(r[3]>>2)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let o=0,s=0;s<256/8;s++){for(let i=0;i<8;i++)r[i]=d(((n[8*s+i]<<4)+3329/2)/3329)&15;t[o++]=r[0]|r[1]<<4,t[o++]=r[2]|r[3]<<4,t[o++]=r[4]|r[5]<<4,t[o++]=r[6]|r[7]<<4}return t}_decompressU(t){let n=new Array(this._k);for(let o=0;o<this._k;o++)n[o]=new Array(384);let r=new Array(4);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/4;i++){r[0]=c(t[o+0])>>0|c(t[o+1])<<8,r[1]=c(t[o+1])>>2|c(t[o+2])<<6,r[2]=c(t[o+2])>>4|c(t[o+3])<<4,r[3]=c(t[o+3])>>6|c(t[o+4])<<2,o=o+5;for(let u=0;u<4;u++)n[s][4*i+u]=k(w(r[u]&1023)*w(3329)+512>>10)}return n}_decompressV(t){let n=new Array(384);for(let r=0,o=0;o<256/2;o++,r++)n[2*o+0]=k(c(t[r]&15)*c(3329)+8>>4),n[2*o+1]=k(c(t[r]>>4)*c(3329)+8>>4);return n}};function nt(e,t){let n=x.sha3_512.create().update(e);t!==void 0&&n.update(t);let r=n.digest();return[r.subarray(0,32),r.subarray(32,64)]}function ee(e){return x.sha3_256.create().update(e).digest()}function Ze(e,t){let n=x.shake256.create({dkLen:32}).update(e);return t!==void 0&&n.update(t),n.digest()}function Ge(e,t){return x.shake128.create({dkLen:672}).update(e).update(t).digest()}function ot(e){let t=0,n=0,r=new Uint8Array(384),o=ae(e);for(let s=0;s<256/2;s++)t=c(o[2*s]),n=c(o[2*s+1]),r[3*s+0]=d(t>>0),r[3*s+1]=d(t>>8)|d(n<<4),r[3*s+2]=d(n>>4);return r}function re(e){let t=new Array(384).fill(0);for(let n=0;n<256/2;n++)t[2*n]=k((c(e[3*n+0])>>0|c(e[3*n+1])<<8)&4095),t[2*n+1]=k((c(e[3*n+1])>>4|c(e[3*n+2])<<4)&4095);return t}function Je(e){let t=new Uint8Array(32),n,r=ae(e);for(let o=0;o<256/8;o++){t[o]=0;for(let s=0;s<8;s++)n=((c(r[8*o+s])<<1)+c(3329/2))/c(3329)&1,t[o]|=d(n<<s)}return t}function Ye(e){let t=new Array(384).fill(0),n;for(let r=0;r<256/8;r++)for(let o=0;o<8;o++)n=-1*k(e[r]>>o&1),t[8*r+o]=n&k(3330/2);return t}function ne(e,t,n){let r=new Array(384).fill(0),o=0,s,i;for(let u=0;o<n&&u+3<=t;)s=(c(e[u]>>0)|c(e[u+1])<<8)&4095,i=(c(e[u+1]>>4)|c(e[u+2])<<4)&4095,u=u+3,s<3329&&(r[o]=s,o=o+1),o<n&&i<3329&&(r[o]=i,o=o+1);return[r,o]}function oe(e,t){let n,r,o,s,i=new Array(384).fill(0);for(let u=0;u<256/8;u++){n=te(e.subarray(4*u,e.length)),r=n&1431655765,r=r+(n>>1&1431655765);for(let p=0;p<8;p++)o=k(r>>4*p+0&3),s=k(r>>4*p+t&3),i[8*u+p]=o-s}return i}function $(e){for(let t=0,n=1,r=128;r>=2;r>>=1)for(let o=0;o<256;o=t+r){let s=C[n];for(n=n+1,t=o;t<o+r;t++){let i=P(s,e[t+r]);e[t+r]=e[t]-i,e[t]=e[t]+i}}return e}function P(e,t){return ce(e*t)}function T(e){for(let t=0;t<256;t++)e[t]=ue(e[t]);return e}function ue(e){let n=(16777216+3329/2)/3329*e>>24;return n=n*3329,e-n}function ce(e){let n=k(Q(e)*62209)*3329;return n=e-n,n>>=16,k(n)}function tr(e){for(let n=0;n<256;n++)e[n]=ce(Q(e[n])*Q(1353));return e}function W(e,t){let n=se(e[0],t[0]),r;for(let o=1;o<e.length;o++)r=se(e[o],t[o]),n=K(n,r);return T(n)}function se(e,t){let n,r;for(let o=0;o<256/4;o++)n=ie(e[4*o+0],e[4*o+1],t[4*o+0],t[4*o+1],C[64+o]),r=ie(e[4*o+2],e[4*o+3],t[4*o+2],t[4*o+3],-C[64+o]),e[4*o+0]=n[0],e[4*o+1]=n[1],e[4*o+2]=r[0],e[4*o+3]=r[1];return e}function ie(e,t,n,r,o){let s=new Array(2);return s[0]=P(t,r),s[0]=P(s[0],o),s[0]+=P(e,n),s[1]=P(e,r),s[1]+=P(t,n),s}function K(e,t){let n=new Array(384);for(let r=0;r<256;r++)n[r]=e[r]+t[r];return n}function er(e,t){for(let n=0;n<256;n++)e[n]-=t[n];return e}function st(e){let t=0;for(let n=0,r=2;r<=128;r<<=1)for(let o=0;o<256;o=t+r){let s=Z[n];for(n=n+1,t=o;t<o+r;t++){let i=e[t];e[t]=ue(i+e[t+r]),e[t+r]=i-e[t+r],e[t+r]=P(s,e[t+r])}}for(t=0;t<256;t++)e[t]=P(e[t],Z[127]);return e}function ae(e){for(let t=0;t<256;t++)e[t]-=3329,e[t]+=e[t]>>31&3329;return e}var it=class extends O{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_sampleNoise1(t,n,r){let o=new Array(r);for(let s=0;s<r;s++)o[s]=rr(M(this._eta1*256/4,t,n),this._eta1),n++;return o}};function rr(e,t){let n,r,o,s,i=new Array(384).fill(0);for(let u=0;u<256/4;u++){n=Yt(e.subarray(3*u,e.length)),r=n&2396745,r=r+(n>>1&2396745),r=r+(n>>2&2396745);for(let p=0;p<4;p++)o=k(r>>6*p+0&7),s=k(r>>6*p+t&7),i[4*u+p]=o-s}return i}var ut=class extends O{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}};var ct=class extends O{constructor(){super(),Object.defineProperty(this,"_k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"_du",{enumerable:!0,configurable:!0,writable:!0,value:11}),Object.defineProperty(this,"_dv",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_eta1",{enumerable:!0,configurable:!0,writable:!0,value:2}),Object.defineProperty(this,"_eta2",{enumerable:!0,configurable:!0,writable:!0,value:2}),this._skSize=12*this._k*256/8,this._pkSize=this._skSize+32,this._compressedUSize=this._k*this._du*256/8,this._compressedVSize=this._dv*256/8}_compressU(t,n){let r=new Array(8);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/8;i++){for(let u=0;u<8;u++)r[u]=c(((w(n[s][8*i+u])<<11)+w(3329/2))/w(3329)&2047);t[o++]=d(r[0]>>0),t[o++]=d(r[0]>>8|r[1]<<3),t[o++]=d(r[1]>>5|r[2]<<6),t[o++]=d(r[2]>>2),t[o++]=d(r[2]>>10|r[3]<<1),t[o++]=d(r[3]>>7|r[4]<<4),t[o++]=d(r[4]>>4|r[5]<<7),t[o++]=d(r[5]>>1),t[o++]=d(r[5]>>9|r[6]<<2),t[o++]=d(r[6]>>6|r[7]<<5),t[o++]=d(r[7]>>3)}return t}_compressV(t,n){let r=new Uint8Array(8);for(let o=0,s=0;s<256/8;s++){for(let i=0;i<8;i++)r[i]=d(((w(n[8*s+i])<<5)+w(3329/2))/w(3329))&31;t[o++]=d(r[0]>>0|r[1]<<5),t[o++]=d(r[1]>>3|r[2]<<2|r[3]<<7),t[o++]=d(r[3]>>1|r[4]<<4),t[o++]=d(r[4]>>4|r[5]<<1|r[6]<<6),t[o++]=d(r[6]>>2|r[7]<<3)}return t}_decompressU(t){let n=new Array(this._k);for(let o=0;o<this._k;o++)n[o]=new Array(384);let r=new Array(8);for(let o=0,s=0;s<this._k;s++)for(let i=0;i<256/8;i++){r[0]=c(t[o+0])>>0|c(t[o+1])<<8,r[1]=c(t[o+1])>>3|c(t[o+2])<<5,r[2]=c(t[o+2])>>6|c(t[o+3])<<2|c(t[o+4])<<10,r[3]=c(t[o+4])>>1|c(t[o+5])<<7,r[4]=c(t[o+5])>>4|c(t[o+6])<<4,r[5]=c(t[o+6])>>7|c(t[o+7])<<1|c(t[o+8])<<9,r[6]=c(t[o+8])>>2|c(t[o+9])<<6,r[7]=c(t[o+9])>>5|c(t[o+10])<<3,o=o+11;for(let u=0;u<8;u++)n[s][8*i+u]=w(r[u]&2047)*3329+1024>>11}return n}_decompressV(t){let n=new Array(384),r=new Array(8);for(let o=0,s=0;s<256/8;s++){r[0]=t[o+0]>>0,r[1]=t[o+0]>>5|t[o+1]<<3,r[2]=t[o+1]>>2,r[3]=t[o+1]>>7|t[o+2]<<1,r[4]=t[o+2]>>4|t[o+3]<<4,r[5]=t[o+3]>>1,r[6]=t[o+3]>>6|t[o+4]<<2,r[7]=t[o+4]>>3,o=o+5;for(let i=0;i<8;i++)n[8*s+i]=k(w(r[i]&31)*w(3329)+16>>5)}return n}};export{ct as MlKem1024,it as MlKem512,ut as MlKem768,U as MlKemError};
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
